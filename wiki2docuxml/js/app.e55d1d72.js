(function(e){function t(t){for(var i,o,r=t[0],l=t[1],c=t[2],u=0,p=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);d&&d(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],i=!0,r=1;r<n.length;r++){var l=n[r];0!==a[l]&&(i=!1)}i&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},a={app:0},s=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"00df":function(e,t,n){e.exports=n.p+"img/C_4C_small.7b7a817d.png"},"18dd":function(e,t,n){},"1afe":function(e,t,n){},"1bd9":function(e,t,n){"use strict";n("be79")},3557:function(e,t,n){"use strict";n("a685")},3706:function(e,t,n){"use strict";n("18dd")},"452c":function(e,t,n){},4678:function(e,t,n){var i={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function a(e){var t=s(e);return n(t)}function s(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=s,e.exports=a,a.id="4678"},"479e":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a,s,o=n("2b0e"),r=n("289d"),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[e._m(0),i("b-modal",{attrs:{width:1e3,scroll:"keep"},model:{value:e.isAddExtendedLinks,callback:function(t){e.isAddExtendedLinks=t},expression:"isAddExtendedLinks"}},[i("header",{staticClass:"modal-card-head"},[i("p",{staticClass:"modal-card-title"},[e._v("選擇需要的關鍵字")]),i("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:function(t){return e.confirmAdd(0)}}})]),i("section",{staticClass:"modal-card-body"},e._l(e.refLinks,(function(t,n){return i("div",{key:n},[i("b-checkbox",{attrs:{size:"is-medium","native-value":t},model:{value:e.selectRefLinks,callback:function(t){e.selectRefLinks=t},expression:"selectRefLinks"}},[e._v(e._s(t))])],1)})),0),i("footer",{staticClass:"modal-card-foot"},[i("button",{staticClass:"button is-success",on:{click:function(t){return e.confirmAdd(1)}}},[e._v(" 保存結果 ")]),i("button",{staticClass:"button",on:{click:function(t){return e.confirmAdd(0)}}},[e._v("取消")])])]),i("b-modal",{attrs:{scroll:"keep"},model:{value:e.isCheckBook,callback:function(t){e.isCheckBook=t},expression:"isCheckBook"}},[i("header",{staticClass:"modal-card-head"},[i("p",{staticClass:"modal-card-title"},[e._v("目前已選書籍｜點擊可刪除書籍")])]),i("footer",{staticClass:"modal-card-foot"},[i("button",{staticClass:"button is-success",on:{click:function(t){e.isCheckBook=!1}}},[e._v(" 返回 ")])])]),i("b-modal",{attrs:{width:400},model:{value:e.isOpenUploadModal,callback:function(t){e.isOpenUploadModal=t},expression:"isOpenUploadModal"}},[i("header",{staticClass:"modal-card-head",staticStyle:{"justify-content":"space-between"}},[i("p",{staticClass:"modal-card-title"},[e._v("上傳到DocuSky")]),i("b-tooltip",{attrs:{label:"到DocuSky看看結果吧！",position:"is-left"}},[i("a",{attrs:{href:"https://docusky.org.tw/DocuSky/docuTools/userMain/",target:"_blank"}},[i("nav",{staticClass:"level"},[i("div",{staticClass:"level-item"},[i("img",{attrs:{src:n("00df"),alt:""}})]),i("div",{staticClass:"level-item",staticStyle:{"padding-top":"5px"}},[i("b-icon",{attrs:{icon:"upload",pack:"fas"}})],1)])])])],1),i("section",{staticClass:"modal-card-body login"},[i("b-field",{attrs:{label:"檔案名稱"}},[i("b-input",{model:{value:e.uploadFileName,callback:function(t){e.uploadFileName=t},expression:"uploadFileName"}})],1),i("b-field",{attrs:{label:"帳號"}},[i("b-input",{model:{value:e.account,callback:function(t){e.account=t},expression:"account"}})],1),i("b-field",{attrs:{label:"密碼"}},[i("b-input",{attrs:{type:"password"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),i("footer",{staticClass:"modal-card-foot",staticStyle:{"justify-content":"space-between"}},[i("div",[i("b-button",{attrs:{type:"is-success",outlined:""},on:{click:e.login}},[e._v(" 登入 ")]),i("b-button",{attrs:{type:"is-success",outlined:"",disabled:!e.isUploadable},on:{click:e.uploadXML}},[e._v(" 上傳 ")])],1),i("div",[i("b-button",{attrs:{type:"is-primary",outlined:""},on:{click:function(t){e.isOpenUploadModal=!1}}},[e._v(" 取消 ")])],1)])]),i("b-modal",{attrs:{width:1e3,scroll:"keep"},model:{value:e.isEditMetaTable,callback:function(t){e.isEditMetaTable=t},expression:"isEditMetaTable"}},[i("header",{staticClass:"modal-card-head"},[i("label",{staticClass:"label"},[e._v("選擇需要的metadata欄位")])]),i("section",{staticClass:"modal-card-body"},[i("b-field",{attrs:{label:"檔案名稱前綴（EX：輸入X則會顯示為X_01.txt）"}},[i("b-input",{model:{value:e.fileNameMeta,callback:function(t){e.fileNameMeta=t},expression:"fileNameMeta"}})],1),i("b-field",{attrs:{label:"文獻集名稱取名"}},[i("b-input",{model:{value:e.corpusNameMeta,callback:function(t){e.corpusNameMeta=t},expression:"corpusNameMeta"}})],1),i("multiselect",{ref:"multiselect",attrs:{options:e.selectMetaDataColumns,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pick some",label:"headerName","track-by":"headerName","preselect-first":!0,"max-height":400},on:{close:e.closeEventHandler},scopedSlots:e._u([{key:"selection",fn:function(t){var n=t.values,a=(t.search,t.isOpen);return[n.length&&!a?i("span",{staticClass:"multiselect__single"},[e._v(" "+e._s(n.length)+" options selected ")]):e._e()]}}]),model:{value:e.selectedMetaDataColumns,callback:function(t){e.selectedMetaDataColumns=t},expression:"selectedMetaDataColumns"}})],1),i("footer",{staticClass:"modal-card-foot"},[i("b-tooltip",{attrs:{label:"下一步編輯Metadata與Tag！",position:"is-right",animated:!1,size:"is-small"}},[i("b-button",{staticClass:"is-primary",attrs:{outlined:""},on:{click:e.splitWikiContents}},[e._v("確認輸出 ")])],1)],1)]),i("b-modal",{attrs:{width:500,scroll:"keep"},model:{value:e.isEditFileOrder,callback:function(t){e.isEditFileOrder=t},expression:"isEditFileOrder"}},[i("header",{staticClass:"modal-card-head"},[i("label",{staticClass:"label"},[e._v("拖曳與重編文件順序")])]),i("section",{staticClass:"modal-card-body"},[i("draggable",e._b({on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1}},model:{value:e.splitCompleteWikiContents,callback:function(t){e.splitCompleteWikiContents=t},expression:"splitCompleteWikiContents"}},"draggable",e.dragOptions,!1),[i("transition-group",{staticClass:"columns is-multiline",attrs:{type:"transition",name:e.drag?null:"flip-list"}},e._l(e.splitCompleteWikiContents,(function(e,t){return i("FileOrder",{key:e.fileName,ref:"fileOrder",refInFor:!0,attrs:{fileName:e.title+"/"+e.fileName,content:e.doc_content,index:t}})})),1)],1)],1),i("footer",{staticClass:"modal-card-foot"},[i("b-button",{staticClass:"is-primary",attrs:{outlined:""},on:{click:e.reOrderFile}},[e._v("重置排序 ")]),i("b-button",{staticClass:"is-primary",attrs:{outlined:""},on:{click:function(t){e.isEditFileOrder=!1}}},[e._v("確認順序 ")])],1)]),i("section",{staticClass:"section"},[i("div",{staticClass:"container is-max-widescreen"},[i("b-steps",{ref:"control",staticClass:"step-custom",class:e.stepClass,attrs:{animated:e.isAnimated,rounded:e.isRounded,"has-navigation":e.hasNavigation,"icon-prev":e.prevIcon,"icon-next":e.nextIcon,"label-position":e.labelPosition,"mobile-mode":e.mobileMode,position:"is-right",vertical:""},scopedSlots:e._u([e.customNavigation?{key:"navigation",fn:function(t){var n=t.previous,a=t.next;return[i("b-button",{attrs:{outlined:"",type:"is-danger","icon-pack":"fas","icon-left":"backward",disabled:n.disabled},on:{click:function(e){return e.preventDefault(),n.action(e)}}},[e._v(" Previous ")]),i("b-button",{attrs:{outlined:"",type:"is-success","icon-pack":"fas","icon-right":"forward",disabled:a.disabled},on:{click:function(e){return e.preventDefault(),a.action(e)}}},[e._v(" Next ")])]}}:null],null,!0),model:{value:e.activeStep,callback:function(t){e.activeStep=t},expression:"activeStep"}},[i("b-step-item",{attrs:{step:"1",label:"關鍵字搜索",clickable:e.isStepsClickable}},[i("section",{staticClass:"section"},[i("label",{staticClass:"label is-large",attrs:{title:"不需完整標題"}},[e._v("文本關鍵字搜索 ")])]),i("section",{staticClass:"section wow"},[i("div",{staticClass:"field has-addons"},[i("div",{staticClass:"control"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.sourceWord,expression:"sourceWord"}],staticClass:"input",attrs:{type:"text",placeholder:"鄭氏紀事"},domProps:{value:e.sourceWord},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getQueryResult(t)},input:function(t){t.target.composing||(e.sourceWord=t.target.value)}}})]),i("div",{staticClass:"control"},[i("a",{staticClass:"button is-link",on:{click:e.getQueryResult}},[e._v(" 搜尋 ")])])])])]),i("b-step-item",{attrs:{step:"2",label:"選擇文本",clickable:e.isStepsClickable,type:{"is-success":e.isProfileSuccess}}},[i("section",{staticClass:"section"},[i("nav",{staticClass:"level"},[i("div",{staticClass:"level-left"},[i("div",{staticClass:"level-item"},[i("label",{staticClass:"label is-large"},[e._v("書本目錄檢視與選取")])])]),i("div",{staticClass:"level-right"},[i("div",{staticClass:"level-item"},[i("b-button",{attrs:{type:"is-success",outlined:""},on:{click:function(t){e.activeStep=2}}},[e._v("選完了")])],1)])])]),e.isInputDataValid?i("section",{staticClass:"section wow"},[i("div",{staticClass:"is-divider"}),i("div",{staticClass:"columns is-multiline"},e._l(e.extendedLinks,(function(t,n){return i("div",{key:n,staticClass:"column is-half"},[i("GetTableContent",{attrs:{link:t,index:n},on:{contentTableAdd:e.addSelectedMenuItem}})],1)})),0)]):e._e()]),i("b-step-item",{attrs:{step:"3",label:"選擇分件方式",clickable:e.isStepsClickable,type:{"is-success":e.isProfileSuccess}}},[i("section",{staticClass:"section"},[i("nav",{staticClass:"level"},[i("div",{staticClass:"level-left"},[i("div",{staticClass:"level-item"},[i("label",{staticClass:"label is-large"},[e._v(" 目前已下載卷數檢視 & 分件｜ ")])]),i("div",{staticClass:"level-item"},[i("p",[e._v(" 未處理文件： ")])]),i("div",{staticClass:"level-item"},[i("b-checkbox",{model:{value:e.isKeepHyperLink,callback:function(t){e.isKeepHyperLink=t},expression:"isKeepHyperLink"}},[e._v(" 保留超連結 ")])],1),i("div",{staticClass:"level-item"},[i("b-checkbox",{model:{value:e.isCutFileByPara,callback:function(t){e.isCutFileByPara=t},expression:"isCutFileByPara"}},[e._v(" 以段分件 ")])],1)]),i("div",{staticClass:"level-right"},[i("div",{staticClass:"level-item"},[i("b-button",{attrs:{type:"is-success",outlined:""},on:{click:e.openEditTable}},[e._v(" 確認分件完成 ")])],1)])])]),i("section",{staticClass:"section wow"},e._l(e.selectedBookMenuPool,(function(t,n){return i("div",{key:n,staticClass:"columns is-multiline"},e._l(t.menu,(function(t,a){return i("div",{key:a,staticClass:"column is-one-third"},[i("BookChildContent",{ref:"contentTable",refInFor:!0,attrs:{"wiki-book":t,bookOrder:n,order:a},on:{"handle-wiki":e.handleWikiCutObj,"delete-book":e.deleteBook,"update:wikiBook":function(e){t=e},"update:wiki-book":function(e){t=e}}})],1)})),0)})),0)]),i("b-step-item",{attrs:{step:"4",label:"編輯Metadata",clickable:e.isStepsClickable,type:{"is-success":e.isProfileSuccess}}},[i("section",[i("nav",{staticClass:"level"},[i("div",{staticClass:"level-left"},[i("div",{staticClass:"level-item"},[i("label",{staticClass:"label is-large"},[e._v("編輯metadata區域｜")]),i("div",{staticClass:"buttons"},[i("b-button",{attrs:{type:"is-primary",outlined:""},on:{click:e.undoHot}},[i("b-icon",{attrs:{icon:"undo","icon-pack":"fas"}})],1),i("b-button",{attrs:{type:"is-primary",outlined:""},on:{click:e.redoHot}},[i("b-icon",{attrs:{icon:"redo","icon-pack":"fas"}})],1)],1)])]),i("div",{staticClass:"level-right"},[i("div",{staticClass:"level-it"},[i("b-button",{staticClass:"is-success",attrs:{outlined:""},on:{click:function(t){e.activeStep=4}}},[e._v("完成編輯 ")])],1)])])]),i("section",{staticClass:"dataHandsonTable wow"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isEditMetadata,expression:"isEditMetadata"}]},[i("hot-table",{ref:"hotTableComponent",attrs:{data:e.splitCompleteWikiContents,rowHeaders:!0,licenseKey:e.licenseKey,height:"580",autoRowSize:!0,colHeaders:e.colHeaders,manualRowResize:!0,manualColumnResize:[200,250],wordWrap:!1,autoWrapCol:!1},on:{"update:data":function(t){e.splitCompleteWikiContents=t}}})],1)])]),i("b-step-item",{attrs:{step:"5",label:"編輯Tag&順序",clickable:e.isStepsClickable,type:{"is-success":e.isProfileSuccess}}},[i("section",{staticClass:"section"},[i("nav",{staticClass:"level"},[i("div",{staticClass:"level-left"},[i("div",{staticClass:"level-item"},[i("label",{staticClass:"label is-large"},[e._v("點擊檢視文本 & 編輯Tag｜")])])]),i("div",{staticClass:"level-right"},[i("div",{staticClass:"level-item"},[i("b-button",{attrs:{type:"is-success",outlined:""},on:{click:function(t){e.isEditFileOrder=!0}}},[e._v("排列文件順序")])],1),i("div",{staticClass:"level-item"},[i("b-button",{attrs:{type:"is-success",outlined:""},on:{click:e.generateXml}},[e._v("輸出XML")])],1)])])]),i("section",{staticClass:"section wow"},[i("b-field",[i("multiselect",{attrs:{"tag-placeholder":"新增自訂tag",placeholder:"選擇需要的tag或輸入自訂的tag名稱(請用英文)",label:"tagLabel","track-by":"tagName","close-on-select":!1,"clear-on-select":!1,options:e.wikiTagOptions,multiple:!0,taggable:!0},on:{remove:e.deleteAllTag,tag:e.addContentTag},model:{value:e.wikiTags,callback:function(t){e.wikiTags=t},expression:"wikiTags"}})],1),i("div",{staticClass:"columns is-multiline"},e._l(e.splitCompleteWikiContents,(function(t,n){return i("TagEdit",{key:t.fileName,ref:"editTag",refInFor:!0,attrs:{fileName:t.title+"/"+t.fileName,content:t.doc_content,index:n,tagOptions:e.wikiTags},on:{"handle-tag":e.handleWikiTag}})})),1)],1)]),i("b-step-item",{attrs:{step:"6",label:"輸出資料",clickable:e.isStepsClickable,type:{"is-success":e.isProfileSuccess}}},[i("section",{staticClass:"section"},[i("div",{staticClass:"buttons"},[i("b-button",{staticClass:"is-medium is-success",attrs:{outlined:""},on:{click:e.copyXML}},[e._v("複製DocuXML到剪貼簿")]),i("b-button",{staticClass:"is-medium is-success",attrs:{outlined:""},on:{click:e.downloadXML}},[e._v("下載XML檔案進一步編輯")]),i("b-button",{staticClass:"is-medium is-success",attrs:{outlined:""},on:{click:e.openLoginModal}},[e._v("直接上傳到DocuSky建庫")])],1)]),i("section",{staticClass:"section wow"},[i("SimpleXml",{attrs:{xml:e.xml,step:e.activeStep}})],1)])],1)],1)])],1)},c=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"hero is-primary is-small"},[n("div",{staticClass:"hero-head"},[n("nav",{staticClass:"navbar"},[n("div",{staticClass:"container"},[n("div",{staticClass:"navbar-menu"},[n("div",{staticClass:"navbar-start"},[n("div",{staticClass:"navbar-item"},[n("h4",{staticClass:"title is-4"},[e._v("Wiki2DocuXml")])])]),n("div",{staticClass:"navbar-end"},[n("a",{staticClass:"navbar-item",attrs:{target:"_blank",href:"../../../index2_20181204.html"}},[e._v(" 首頁 ")]),n("a",{staticClass:"navbar-item",attrs:{target:"_blank",href:"../../userMain/"}},[e._v(" 我的資料庫 ")]),n("a",{staticClass:"navbar-item",attrs:{target:"_blank",href:"https://imgur.com/a/or62eEO"}},[e._v(" 教學（暫） ")]),n("a",{staticClass:"navbar-burger",attrs:{role:"button","aria-label":"menu","aria-expanded":"false"}},[n("span",{attrs:{"aria-hidden":"true"}}),n("span",{attrs:{"aria-hidden":"true"}}),n("span",{attrs:{"aria-hidden":"true"}})])])])])])])])}],d=n("1da1"),u=n("8785"),p=(n("96cf"),n("ac1f"),n("5319"),n("a434"),n("159b"),n("4d63"),n("25f0"),n("d80f"),n("99af"),n("7db0"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),[{field:"author",headerName:"文件作者"},{field:"doc_source",headerName:"文件來源"},{field:"doc_topic_l1",headerName:"文件主題階層一"},{field:"doc_topic_l2",headerName:"文件主題階層二"},{field:"doc_topic_l3",headerName:"文件主題階層三"},{field:"geo_level1",headerName:"文件地域階層一"},{field:"geo_level2",headerName:"文件地域階層二"},{field:"geo_level3",headerName:"文件地域階層三"},{field:"geo_longitude",headerName:"文件所在經度"},{field:"geo_latitude",headerName:"文件所在緯度"},{field:"doc_category_l1",headerName:"文件分類階層一"},{field:"doc_category_l2",headerName:"文件分類階層二"},{field:"doc_category_l3",headerName:"文件分類階層三"},{field:"docclass",headerName:"文件類別"},{field:"docclass_aux",headerName:"文件子類別"},{field:"doctype",headerName:"文件型態"},{field:"doctype_aux",headerName:"文件子型態"},{field:"book_code",headerName:"文件書碼"},{field:"time_orig_str",headerName:"文件時間(字串)"},{field:"time_varchar",headerName:"文件時間(西曆)"},{field:"time_norm_year",headerName:"文件時間(中曆)"},{field:"era",headerName:"文件時間(年號)"},{field:"time_norm_kmark",headerName:"文件時間(帝號)"},{field:"year_for_grouping",headerName:"文件時間(西元年)"},{field:"time_dynasty",headerName:"文件時間(朝代)"},{field:"doc_seq_number",headerName:"文件順序"},{field:"timeseq_not_before",headerName:"文件起始時間"},{field:"timeseq_not_after",headerName:"文件結束時間"},{field:"doc_attachment",headerName:"文件圖檔"},{field:"doc_att_caption",headerName:"文件圖檔的圖說"}]),f=["文件標題","文獻集名稱","文件作者","文件來源","文件主題階層一","文件主題階層二","文件主題階層三","文件地域階層一","文件地域階層二","文件地域階層三","文件所在經度","文件所在緯度","文件分類階層一","文件分類階層二","文件分類階層三","文件類別","文件子類別","文件型態","文件子型態","文件書碼","文件時間(字串)","文件時間(西曆)","文件時間(中曆)","文件時間(年號)","文件時間(帝號)","文件時間(西元年)","文件時間(朝代)","文件順序","文件起始時間","文件結束時間","文件圖檔","文件圖檔的圖說","文件內容"],m=[{wordWrap:!1},{wordWrap:!1,width:"150px"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"content"},[n("b-field",[n("b-button",{staticClass:"is-primary is-medium book-child",staticStyle:{height:"auto"},attrs:{outlined:"",expanded:""},on:{click:function(t){e.isOpenBook=!0}}},[e._v(" "+e._s(e.wikiBook)+" ")]),n("p",{staticClass:"control"},[n("b-button",{staticClass:"button is-medium is-danger",staticStyle:{height:"auto"},attrs:{outlined:""},on:{click:e.deleteBook}},[n("b-icon",{attrs:{icon:"delete"}})],1)],1)],1)],1),n("b-modal",{attrs:{width:1e3,scroll:"keep"},model:{value:e.isOpenBook,callback:function(t){e.isOpenBook=t},expression:"isOpenBook"}},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-content"},[n("div",{staticClass:"media"},[n("div",{staticClass:"media-content"},[n("label",{staticClass:"label is-large"},[e._v("獲取的WikiSource文本內容 ")]),n("div",{staticClass:"block"},[n("nav",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item"},[n("b-radio",{attrs:{name:"name","native-value":"1"},on:{change:e.getViewArray},model:{value:e.paragraphCutWay,callback:function(t){e.paragraphCutWay=e._n(t)},expression:"paragraphCutWay"}},[e._v(" 以此卷作為一件 ")])],1),n("div",{staticClass:"level-item"},[n("b-radio",{attrs:{name:"name","native-value":"2"},on:{change:e.getViewArray},model:{value:e.paragraphCutWay,callback:function(t){e.paragraphCutWay=e._n(t)},expression:"paragraphCutWay"}},[e._v(" 以段落切開作為一件 ")])],1),n("div",{staticClass:"level-item"},[n("b-radio",{attrs:{name:"name","native-value":"3"},on:{change:e.getViewArray},model:{value:e.paragraphCutWay,callback:function(t){e.paragraphCutWay=e._n(t)},expression:"paragraphCutWay"}},[e._v(" 以自由分段作為分件（以####作為語法輸入） ")])],1),n("div",{staticClass:"level-item"},[n("b-button",{attrs:{type:"is-success is-small",outlined:""},on:{click:function(t){return e.getViewArray(1)}}},[e._v(" 檢視分段結果 ")])],1)])])])])]),e.isPreview?e._e():n("div",[n("textarea",{directives:[{name:"model",rawName:"v-model.lazy",value:e.pureText,expression:"pureText",modifiers:{lazy:!0}}],staticClass:"textarea",attrs:{placeholder:"10 lines of textarea",rows:"20"},domProps:{value:e.pureText},on:{change:function(t){e.pureText=t.target.value}}})]),e.isPreview?n("div",{staticClass:"content"},e._l(e.viewContents,(function(t,i){return n("div",{key:i},[n("textarea",{staticClass:"textarea",attrs:{placeholder:"10 lines of textarea",rows:"5",readonly:""},domProps:{textContent:e._s(t)}}),n("div",{staticClass:"is-divider"})])})),0):e._e()]),n("footer",{staticClass:"modal-card-foot"},[n("section",[n("b-field",[n("b-checkbox",{model:{value:e.isUrlAllow,callback:function(t){e.isUrlAllow=t},expression:"isUrlAllow"}},[e._v(" 保存超連結 ")]),n("b-button",{attrs:{type:"is-success",outlined:""},on:{click:e.sendWikiCutObj}},[e._v("確認分件方式")])],1)],1)])])])],1)},b=[],g=(n("4de4"),n("1276"),n("2909")),w=n("b85c"),v=n("3835"),k=(n("466d"),n("a15b"),n("4fad"),n("841c"),n("6062"),n("1157")),C=n("bc3a"),x=n.n(C),y=new Date;function j(e){return E.apply(this,arguments)}function E(){return E=Object(d["a"])(regeneratorRuntime.mark((function e(t){var n,i,a,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=t.split("\n").filter((function(e){return e})),n=Object(w["a"])(t),e.prev=2,n.s();case 4:if((i=n.n()).done){e.next=23;break}return a=i.value,e.prev=6,e.next=9,x.a.get("https://zh.wikisource.org/w/api.php",{params:{action:"parse",page:a,origin:"*",format:"json",utf8:""}});case 9:return s=e.sent,e.next=12,L(s.data.parse);case 12:return o=e.sent,o=o.filter((function(e){return-1===e.indexOf(t)})),e.abrupt("return",o);case 17:e.prev=17,e.t0=e["catch"](6),console.log(e.t0),alert("請求出錯！");case 21:e.next=4;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e["catch"](2),n.e(e.t1);case 28:return e.prev=28,n.f(),e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[2,25,28,31],[6,17]])}))),E.apply(this,arguments)}function S(e){return T.apply(this,arguments)}function T(){return T=Object(d["a"])(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.get("https://zh.wikisource.org/w/api.php",{params:{action:"query",list:"search",srsearch:t,origin:"*",format:"json",utf8:"",srlimit:100}});case 3:return n=e.sent,e.next=6,n.data.query.search;case 6:return i=e.sent,i=i.map((function(e){return e.title.replace(/\/.*$/g,"").replace(/[0-9-]*$/g,"")})),e.abrupt("return",Object(g["a"])(new Set(i)));case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0),alert("請求出錯！");case 15:case"end":return e.stop()}}),e,null,[[0,11]])}))),T.apply(this,arguments)}function _(e,t){var n=(new DOMParser).parseFromString(e,"text/html"),i=[],a=k(n).find(".mw-parser-output p,.mw-parser-output dd");void 0!==k(a).text()&&k(a).text().match(/重定向/g)&&alert('頁面:"'.concat(t,'"被重新導向至"').concat(k(n).find(".mw-parser-output a").text(),'"，請察看維基文庫頁面確認正確標題或搜尋'));for(var s=0;s<10;s++)k(a).find("*:not(a)").each((function(e,t){var n=k(t).html();k(t).replaceWith(n)}));k(a).find("a").each((function(e,t){var n=k(t).html(),i=void 0!==k(t).attr("href")&&k(t).attr("href").match(/^\/wiki\//g)?"https://zh.wikisource.org".concat(k(t).attr("href")):k(t).attr("href");k(t).replaceWith(P(n,"Udef_wiki",1,' Term="'.concat(n,'" Url="').concat(i,'"')))})),k(a).each((function(e,t){var n=k(t).text().replace(/\s/gm,"").replace(/^\r\n|^\n/gm,"").replace(/（并请在校对之后从条目的源代码中删除本模版：{{简转繁}}）/gm,"").replace(/&lt;(\W+)&gt;/g,"【$1】"),a=k(t).html().replace(/&lt;(\W+)&gt;/g,"【$1】");/(屬於公有領域)/gm.test(n)||""==n||i.push({paragraphs:n,hyperlinks:a.replace(/udef_wiki/g,"Udef_wiki").replace(/url/g,"Url").replace(/term/g,"Term")})}));var o=i.map((function(e){return e.paragraphs})).join("\n"),r=i.map((function(e){return e.hyperlinks})).join("\n");return{paragraphs:o,hyperlinks:r}}function L(e){return O.apply(this,arguments)}function O(){return O=Object(d["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[],Object.prototype.hasOwnProperty.call(t,"links")&&t.links.forEach((function(e){F(e["*"])&&n.push(e["*"])})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function M(e,t){for(var n=(e+"").length;n<t;n=e.length)e="0"+e;return e}function F(e){return!e.match(/(Category.*)|(Author.*)|(Wikisource.*)|(Template.*)|(模块.*)/g)}function P(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return 0==n?"<".concat(t).concat(i,">").concat(e,"</").concat(t,">\n"):"<".concat(t).concat(i,">").concat(e,"</").concat(t,">")}function D(e){var t="";for(var n in e)/\d+/.test(n)&&(t=n);return t}function N(e,t){return A.apply(this,arguments)}function A(){return A=Object(d["a"])(regeneratorRuntime.mark((function e(t,n){var i,a,s,o,r,l,c,d,u,p,f=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=f.length>2&&void 0!==f[2]?f[2]:{},a=f.length>3?f[3]:void 0,"numOfDir"in i||(i.numOfDir=0),e.prev=3,e.next=6,x.a.get("https://zh.wikisource.org/w/api.php?format=json&action=query&prop=revisions&rvprop=content&utf8",{params:{titles:t,origin:"*"}});case 6:if(s=e.sent,s=s.data,o=D(s.query.pages),r=s.query.pages[o].revisions[0]["*"],l=s.query.pages[o].title,c=r.match(/.*\[\[(\/*.*)\|*.*\]\]/gm),d=t.match(/^[^/]*/),c=c.join("\n").replace(/^\n/gm,"").replace(/^\n/gm,"").match(/^[=*#!].*\[\[(.*)\|*.*\]\]/gm),d&&(c=c.filter((function(e){return e}))),c){for(c=c.join("\n"),c=c.replace(/.*\[\[(.*\/*.*)\|*.*\]\]/gm,"$1").replace(/\|.*/gm,""),u=c.split("\n"),i.numOfDir+=u.length,p=0;p<u.length;p++)i.numOfDir--,/^\/.*/.test(u[p])&&(u[p]=l+u[p]),-1!=a.indexOf(u[p])||/.*全覽.*/.test(u[p])||a.push({index:p,value:u[p]});0===i.numOfDir&&(a=U(a))}else c||a.push({index:0,id:l,label:l});return e.abrupt("return",a);case 19:e.prev=19,e.t0=e["catch"](3),console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[3,19]])}))),A.apply(this,arguments)}function U(e){var t=e,n=[];return t.forEach((function(e){var t=e.value.split("/");t.reduce((function(n,i,a){var s=n.find((function(e){var t=e.id;return i===t})),o=!0;return s||(o=a===t.length,s={id:i,label:i,index:e.index,value:"",isLeaf:o,children:[]},o&&delete s["children"],n.push(s)),s.children}),n)})),I(n),n}function I(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=0;i<e.length;i++)e[i].index=n,e[i].id="".concat(t,"/").concat(e[i].label).replace(/^\//,""),n++,0!==e[i].children.length?n=I(e[i].children,e[i].id,n):e[i].isLeaf=!0;return n}function R(e){return W.apply(this,arguments)}function W(){return W=Object(d["a"])(regeneratorRuntime.mark((function e(t){var n,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.get("https://zh.wikisource.org/w/api.php",{params:{action:"parse",page:t,origin:"*",format:"json",utf8:""}});case 3:return n=e.sent,n=n.data.parse.text["*"],i=(new DOMParser).parseFromString(n,"text/html"),a=k(i).find("div#headerContainer.ws-noexport.noprint table tbody tr td").text(),a=a.replace(/姊妹計劃.*/g,"").replace(/版本信息.*/g,"").replace(/(維基百科條目|维基百科條目).*/g,""),e.abrupt("return",a);case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),W.apply(this,arguments)}function B(e){return z.apply(this,arguments)}function z(){return z=Object(d["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,x.a.get("https://zh.wikisource.org/w/api.php",{params:{action:"parse",page:t,origin:"*",format:"json",utf8:""}});case 5:return n=e.sent,e.abrupt("return",n.data.parse);case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0),alert("請求出錯！");case 13:case"end":return e.stop()}}),e,null,[[2,9]])}))),z.apply(this,arguments)}function X(e){var t=[];return e.forEach((function(e){var n=!0===e.isUrlAllow?e.wikiText.hyperlinks:e.wikiText.paragraphs,i="";2===e.paragraphCutWay?i=/\n/:3===e.paragraphCutWay&&(i=/####/);var a=""===i?[n]:n.split(i).filter((function(e){return e}));t.push({title:e.title,documents:a})})),t}function q(e,t,n,i){var a=[],s={},o=0;t.forEach((function(e){s[e.field]=""})),e.forEach((function(e){o+=e.documents.length}));var r=o.toString().length;return o=0,e.forEach((function(e){e.documents.forEach((function(t){o++;var l=Object.assign({},{title:"".concat(e.title),doc_content:t.replace(/<Udef_wiki/g,'<mark tag="Udef_wiki"').replace(/\/Udef_wiki/g,"/mark"),fileName:"".concat(n,"_").concat(M(o,r),".txt"),corpus:"".concat(i)},s,{fileOrder:o});a.push(l)}))})),a}function J(e,t){var n=t.match(/.{2}<Udef_wiki[^<]*>[^<]*<\/Udef_wiki>.{2}/g);if(null!==n){var i=e;return n.forEach((function(e){var t=e.replace(/(.{2})<Udef_wiki[^<]*>([^<]*)<\/Udef_wiki>(.{2})/,"$1$2$3");i=i.replace(t,e)})),i}}function $(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=n,o={},r=String.raw(a||(a=Object(u["a"])(["",""])),t),l=String.raw(s||(s=Object(u["a"])(['<mark tag="','">',"</mark>"])),e,t);function c(e){var t=0,n=e,i=new RegExp("(<mark[^>]*>[^<]*</mark>)");function a(e){return o["###".concat(t,"@###")]=e,"###".concat(t,"@###")}while(n.match(i))n=n.replace(i,a),t++;return n}function d(e){for(var t=e,n=0,i=Object.entries(o);n<i.length;n++){var a=Object(v["a"])(i[n],2),s=a[0],r=a[1];t=t.replace(new RegExp(s),r)}return o={},t}return i=c(i),i=i.replace(new RegExp(r,"g"),l),i=d(i),i}k["expr"][":"].regex=function(e,t,n){var i=n[3].split(","),a=/^(data|css):/,s={method:i[0].match(a)?i[0].split(":")[0]:"attr",property:i.shift().replace(a,"")},o="ig",r=new RegExp(i.join("").replace(/^\s+|\s+$/g,""),o);return r.test(k(e)[s.method](s.property))};var H={name:"BookChildContent",data:function(){return{isOpenBook:!1,paragraphCutWay:1,wikiObj:{},wikiText:{paragraphs:"",hyperlinks:""},isUrlAllow:!1,isViewed:!1,viewContents:[],isPreview:!1}},props:["wikiBook","order","bookOrder"],methods:{sendWikiCutObj:function(){this.$emit("handle-wiki",{title:this.wikiBook,order:this.order,paragraphCutWay:this.paragraphCutWay,isUrlAllow:this.isUrlAllow,wikiText:{paragraphs:this.pureText,hyperlinks:this.wikiText.hyperlinks}}),this.isOpenBook=!1,this.isViewed=!0},getViewArray:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.viewContents=[];var t=!0===this.isUrlAllow?this.wikiText.hyperlinks:this.pureText,n="";2===this.paragraphCutWay?n=/\n/:3===this.paragraphCutWay&&(n=/####/);var i=""===n?[t]:t.split(n).filter((function(e){return e}));this.$nextTick((function(){this.viewContents=i})),1===e&&(this.isPreview=!this.isPreview)},deleteBook:function(){this.$emit("delete-book",{bookOrder:this.bookOrder,chapOrder:this.order})}},computed:{pureText:{get:function(){return this.wikiText.hyperlinks.replace(/\n{0,1}<Udef_wiki[^<]*>\n*([^<]*)\n*<\/Udef_wiki>\n{0,1}/gm,"$1")},set:function(e){this.wikiText.hyperlinks=J(e,this.wikiText.hyperlinks)}}},created:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,B(this.wikiBook);case 2:this.wikiObj=e.sent,this.wikiText=_(this.wikiObj.text["*"]);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},V=H,G=(n("3706"),n("2877")),Y=Object(G["a"])(V,h,b,!1,null,"bc59f6c6",null),K=Y.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"tagParent",staticClass:"column is-one-third"},[n("div",{staticClass:"content"},[n("b-button",{staticClass:"is-primary",attrs:{outlined:"",expanded:""},on:{click:function(t){e.isOpenTagModal=!0}}},[e._v(e._s(e.fileName)+" ")])],1),e.isTagOpen?n("div",{ref:"selbox",staticClass:"selectTagBox"},[e._l(e.tagOptions,(function(t,i){return n("span",{key:i},[n("b-radio",{attrs:{type:"radio","native-value":t.tagName},model:{value:e.selectTag,callback:function(t){e.selectTag=t},expression:"selectTag"}},[e._v(" "+e._s(t.tagLabel))])],1)})),n("div",[n("b-button",{attrs:{type:"is-small"},on:{click:e.setTag}},[e._v("確認")]),n("b-button",{attrs:{type:"is-small"},on:{click:function(t){e.isTagOpen=!1}}},[e._v("取消")])],1)],2):e._e(),e.isCheckTagName?n("div",{ref:"checkTagBox",staticClass:"selectTagBox"},[n("span",[e._v(e._s(e.showTagName))])]):e._e(),n("b-modal",{attrs:{width:1e3,scroll:"keep"},model:{value:e.isOpenTagModal,callback:function(t){e.isOpenTagModal=t},expression:"isOpenTagModal"}},[n("header",{staticClass:"modal-card-head"},[n("nav",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item"},[n("p",{staticClass:"modal-card-title"},[e._v("編輯Tag")])]),n("div",{staticClass:"level-item"},[n("h6",[e._v("劃記後選擇Tag名稱，再次點擊Tag即可刪除")])])])])]),n("section",{staticClass:"modal-card-body"},[n("div",[n("div",{ref:"text",staticStyle:{"white-space":"pre-wrap"},domProps:{innerHTML:e._s(e.content)},on:{mouseup:e.print}})])]),n("footer",{staticClass:"modal-card-foot"},[n("b-button",{attrs:{type:"is-success",outlined:""},on:{click:e.saveTag}},[e._v("保存Tag")]),n("b-button",{attrs:{type:"is-primary",outlined:""},on:{click:function(t){e.isOpenTagModal=!1}}},[e._v("取消")])],1)])],1)},Z=[],ee={name:"TagEdit",watch:{isOpenTagModal:function(e){var t=this;this.$nextTick((function(){e&&t.actionShowTag()})),e||(this.isTagOpen=!1)}},data:function(){return{wordSelection:void 0,wordRange:void 0,selectTag:"",isTagOpen:!1,isOpenTagModal:!1,extractCompleteTags:{},isMouseMove:!1,isCheckTagName:!1,showTagName:"",markBucket:{}}},props:["fileName","content","index","tagOptions"],methods:{handleOut:function(e){this.isCheckTagName=!1,e.target.removeEventListener("mouseleave",this.handleOut)},handleIn:function(e){var t=this;"MARK"===e.target.tagName&&(this.isCheckTagName=!0,this.showTagName=e.target.attributes.tag.value,this.$nextTick((function(){t.$refs.checkTagBox.style.left="".concat(e.clientX+20,"px"),t.$refs.checkTagBox.style.top="".concat(e.clientY+20,"px")})),setTimeout((function(){t.isCheckTagName=!1}),1e3))},print:function(e){var t=this;if("MARK"!==e.target.tagName){this.wordSelection=window.getSelection();var n=this.wordSelection.getRangeAt(0).getBoundingClientRect(),i=n.width;i&&(this.isTagOpen=!0,this.$nextTick((function(){t.$refs.selbox.style.left="".concat(e.clientX+20,"px"),t.$refs.selbox.style.top="".concat(e.clientY+20,"px")})))}else this.deleteTag(e)},deleteTag:function(e){this.$refs.text.insertBefore(document.createTextNode(e.target.innerText),e.target),this.$refs.text.removeChild(e.target)},setTag:function(){var e=this.wordSelection.toString(),t=document.createElement("mark");t.setAttribute("tag",this.selectTag),t.appendChild(document.createTextNode(e)),this.wordSelection.deleteFromDocument(),this.wordSelection.getRangeAt(0).insertNode(t),this.isTagOpen=!1,this.searchAndTag(this.selectTag,e),this.extractCompleteTags[this.selectTag]=this.extractCompleteTags[this.selectTag]?this.extractCompleteTags[this.selectTag]+", "+e:e},searchAndTag:function(e,t){this.$refs.text.innerHTML=$(e,t,this.$refs.text.innerHTML)},actionShowTag:function(){this.$refs.text.addEventListener("mouseover",this.handleIn)},saveTag:function(){this.$emit("handle-tag",{newContent:this.$refs.text.innerHTML,index:this.index}),this.isOpenTagModal=!1}}},te=ee,ne=(n("62b8"),Object(G["a"])(te,Q,Z,!1,null,"13839d37",null)),ie=ne.exports,ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{width:1e3,scroll:"keep"},model:{value:e.isAddMenuToDownload,callback:function(t){e.isAddMenuToDownload=t},expression:"isAddMenuToDownload"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[e._v("建立目錄樹狀結構")]),n("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:function(t){e.isAddMenuToDownload=!1}}})]),n("section",{staticClass:"modal-card-body"},[n("div",{staticClass:"tile is-ancestor"},[n("div",{staticClass:"tile is-7 is-parent"},[n("div",{staticClass:"tile is-child in-modal box"},[n("p",{staticClass:"title"},[e._v("目錄")]),n("treeselect",{attrs:{multiple:!0,options:e.treeShowMenu,"sort-value-by":e.sortValueBy,"value-consists-of":e.valueConsistsOf,limit:0,"always-open":!0,"default-expand-level":1,"max-height":400,noChildrenText:"無子目錄"},model:{value:e.tempSelectMenu,callback:function(t){e.tempSelectMenu=t},expression:"tempSelectMenu"}})],1)]),n("div",{staticClass:"tile is-vertical is-parent"},[n("div",{staticClass:"tile is-child box"},[n("div",{staticClass:"content"},[n("h5",[e._v("簡介")])]),n("div",{staticClass:"content",staticStyle:{"max-height":"30em",overflow:"auto"}},[n("p",{domProps:{textContent:e._s(e.wikiContentSnippet)}})])])])])]),n("footer",{staticClass:"modal-card-foot"},[n("button",{staticClass:"button is-success",on:{click:e.addSelectedMenuItem}},[e._v(" 保存結果 ")]),n("button",{staticClass:"button",on:{click:function(t){e.isAddMenuToDownload=!1}}},[e._v(" 取消 ")])])]),n("div",{staticClass:"box"},[n("div",{staticClass:"container"},[n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered",staticStyle:{"flex-shrink":"1"}},[n("h4",{staticClass:"title is-4"},[e._v(e._s(e.link))])]),n("div",{staticClass:"level-right"},[n("b-button",{staticClass:"button is-primary is-medium",on:{click:e.getMenuOfContent}},[n("b-icon",{attrs:{icon:"search",pack:"fas"}})],1)],1)])])])],1)},se=[],oe=(n("9911"),n("ca17")),re=n.n(oe),le={name:"GetTableContent",components:{Treeselect:re.a},data:function(){return{isAddMenuToDownload:!1,tempSelectMenu:[],treeShowMenu:[],sortValueBy:"INDEX",wikiContentSnippet:"",extendedLinks:[],valueConsistsOf:"ALL",data:[{label:"Same but with checkboxesSame but with checkboxesSame but with checkboxesSame but with checkboxesSame but with checkboxesSame but with checkboxesSame but with checkboxesSame but with checkboxesSame but with checkboxesSame but with checkboxesSame but with checkboxesSame but with checkboxes",id:"wowowSame but with checkboxes",value:"WOWOWOWOWO",children:[{label:"initially selected",id:"wowowinitially selected",selected:!0},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"initially open",id:"wowowinitially open",icon:"fa fa-folder icon-state-default",opened:!0,children:[{label:"Another node",id:"wowowAnother node"}]},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-warning"},{label:"disabled node",id:"wowowdisabled node",icon:"fa fa-check icon-state-success",disabled:!0}]},{label:"Same but with checkboxes",id:"wowowSame but with checkboxes",opened:!0,children:[{label:"initially selected",id:"wowowinitially selected",selected:!0},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-danger"},{label:"initially open",id:"wowowinitially open",icon:"fa fa-folder icon-state-default",opened:!0,children:[{label:"Another node",id:"wowowAnother node"}]},{label:"custom icon",id:"wowowcustom icon",icon:"fa fa-warning icon-state-warning"},{label:"disabled node",id:"wowowdisabled node",icon:"fa fa-check icon-state-success",disabled:!0}]},{label:"And wholerow selection",id:"wowowAnd wholerow selection"},{label:"drag disabled",id:"wowowdrag disabled",icon:"fa fa-warning icon-state-danger",dragDisabled:!0},{label:"drop disabled",id:"wowowdrop disabled",icon:"fa fa-warning icon-state-danger",dropDisabled:!0}]}},props:["link","index"],methods:{getMenuOfContent:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R(this.link);case 3:return this.wikiContentSnippet=e.sent,e.next=6,N(this.link,0,{},[]);case 6:this.treeShowMenu=e.sent,this.isAddMenuToDownload=!0,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log("獲取失敗。");case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}(),addSelectedMenuItem:function(){this.$emit("contentTableAdd",{index:this.index,searchName:this.link,menu:this.tempSelectMenu}),this.isAddMenuToDownload=!1}}},ce=le,de=(n("3557"),Object(G["a"])(ce,ae,se,!1,null,"f9c6f0aa",null)),ue=de.exports,pe=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},fe=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"simp-container"},[n("div",{attrs:{id:"simpleXml"}})])}];n("b0c0"),n("498a");function me(e,t,n){if(t)if(9!=t.nodeType)switch(t.nodeType){case 1:var i=t.childNodes.length>0,a=i&&(t.childNodes.length>1||3!=t.childNodes[0].nodeType),s=a?b("","simpleXML-expanderHeader"):e,o=b("","simpleXML-expander");a&&k(o).addClass("simpleXML-expander-expanded"),s.appendChild(o),s.appendChild(b("<","simpleXML-tagHeader")),s.appendChild(b(t.nodeName,"simpleXML-tagValue")),a&&e.appendChild(s);for(var r=t.attributes,l=0;l<r.length;l++)s.appendChild(b(" ")),s.appendChild(b(r[l].name,"simpleXML-attrName")),s.appendChild(b('="')),s.appendChild(b(r[l].value,"simpleXML-attrValue")),s.appendChild(b('"'));if(i){if(e.appendChild(b(">","simpleXML-tagHeader")),a){for(var c=document.createElement("ul"),d=0;d<t.childNodes.length;d++){var u=document.createElement("li");me(u,t.childNodes[d],n),c.appendChild(u)}var p=b(n.collapsedText,"simpleXML-collapsedText");p.setAttribute("style","display: none;"),c.setAttribute("class","simpleXML-content"),e.appendChild(p),e.appendChild(c),e.appendChild(b("","simpleXML-expanderClose"))}else e.appendChild(b(t.childNodes[0].nodeValue));e.appendChild(b("</","simpleXML-tagHeader")),e.appendChild(b(t.nodeName,"simpleXML-tagValue")),e.appendChild(b(">","simpleXML-tagHeader"))}else{var f=document.createElement("span");f.innerText="/>",e.appendChild(f)}break;case 3:""!==t.nodeValue.trim()&&(e.appendChild(b("","simpleXML-expander")),e.appendChild(b(t.nodeValue)));break;case 4:e.appendChild(b("","simpleXML-expander")),e.appendChild(b("<![CDATA[","simpleXML-tagHeader")),e.appendChild(b(t.nodeValue,"simpleXML-cdata")),e.appendChild(b("]]>","simpleXML-tagHeader"));break;case 8:e.appendChild(b("","simpleXML-expander")),e.appendChild(b("\x3c!--"+t.nodeValue+"--\x3e","simpleXML-comment"));break;default:var m=document.createElement("span");m.innerText=t.nodeType+" - "+t.name,e.appendChild(m);break}else for(var h=0;h<t.childNodes.length;h++)me(e,t.childNodes[h],n);function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=document.createElement("span");return n.innerText=e,void 0!=t&&n.setAttribute("class",t),n}}k["fn"].simpleXML=function(e){var t=k["extend"]({collapsedText:"..."},e);if(void 0==t.xml&&void 0==t.xmlString)throw"No XML to be displayed was supplied";if(void 0!=t.xml&&void 0!=t.xmlString)throw"Only one of xml and xmlString may be supplied";var n=t.xml;return void 0==n&&(n=k["parseXML"](t.xmlString)),this.each((function(){var e=document.createElement("span");k(e).addClass("simpleXML"),me(e,n,t),this.appendChild(e),k(e).find(".simpleXML-expanderHeader").click((function(){var e=k(this).closest(".simpleXML-expanderHeader"),t=e.find(".simpleXML-expander"),n=e.parent().find(".simpleXML-content").first(),i=e.parent().children(".simpleXML-collapsedText").first(),a=e.parent().children(".simpleXML-expanderClose").first();t.hasClass("simpleXML-expander-expanded")?(t.removeClass("simpleXML-expander-expanded").addClass("simpleXML-expander-collapsed"),i.attr("style","display: inline;"),n.attr("style","display: none;"),a.attr("style","display: none")):(t.addClass("simpleXML-expander-expanded").removeClass("simpleXML-expander-collapsed"),i.attr("style","display: none;"),n.attr("style",""),a.attr("style",""))}))}))};var he={name:"SimpleXml",props:["step","xml"],watch:{step:function(e){5===e&&k("#simpleXml").simpleXML({xmlString:this.xml})}}},be=he,ge=(n("ea11"),Object(G["a"])(be,pe,fe,!1,null,null,null)),we=ge.exports,ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"column is-12"},[n("div",{staticClass:"content"},[n("b-button",{staticClass:"is-primary is-light",attrs:{expanded:"",static:""}},[e._v(e._s(e.fileName)+" ")])],1)])},ke=[],Ce={name:"FileOrder",data:function(){return{}},props:["fileName","content","index"],methods:{}},xe=Ce,ye=(n("1bd9"),Object(G["a"])(xe,ve,ke,!1,null,"20325a6c",null)),je=ye.exports,Ee=n("b76a"),Se=n.n(Ee),Te=(n("542c"),n("3c78")),_e=(n("8033"),n("8e5f")),Le=n.n(_e);n("e607"),n("fb6a");function Oe(e,t,n,i){var a=t.slice(0);a.unshift({field:"title",headerName:"文件標題"},{field:"doc_content",headerName:"文本內容"},{field:"fileName",headerName:"檔案名稱"},{field:"corpus",headerName:"文獻集名稱"});var s="";return s+=Me(a,n,i),s+=Fe(e),s=De("ThdlPrototypeExport",s,!1,[1,1]),s='<?xml version="1.0"?>\n'+s.replace(/\n\n/g,"\n"),s}function Me(e,t,n){var i="",a="",s="";return e.forEach((function(e){var t=De(e.field,e.headerName,!1,[0,1]);t=Ae("show_spotlight","Y",t,!1),t=Ae("display_order","999",t,!1),i+=t})),i=De("metadata_field_settings",i,!1,[1,1]),t.forEach((function(e){var t='<spotlight category="'.concat(e.tagName,'" sub_category="-" display_order="1" title="').concat(e.tagLabel,'"/>\n');t+='<tag type="contentTagging" name="'.concat(e.tagName,'" default_category="').concat(e.tagName,'" default_sub_category="-"/>\n'),a+=t})),a=De("feature_analysis",a,!1,[1,1]),s=i+a,s=De("corpus",s,!1,[1,1]),s=Ae("name",n,s,!1),s}function Fe(e){var t=e.map((function(e){for(var t="",n="",i="",a=0,s=Object.entries(e);a<s.length;a++){var o=Object(v["a"])(s[a],2),r=o[0],l=o[1];"doc_content"!==r&&"fileName"!==r?t+=De(r,l,!1,[0,1]):"doc_content"===r?n=l:"fileName"===r&&(i=l)}return n=Pe(Ue(n)),t+=De("doc_content",n,!1,[1,1]),t=De("document",t,!1,[1,1]),t=Ae("fileName",i,t,!1),t})).join("");return De("documents",t,!1,[1,1])}function Pe(e){var t=e,n=t.split("\n").filter((function(e){return e})).map((function(e){return De("Paragraph",e,!1,[1,1])})).join("");return n}function De(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0],a=n?Ne(e):e,s=["","\n"];return"<".concat(a,">").concat(s[i[0]]).concat(t).concat(s[i[0]],"</").concat(a,">").concat(s[i[1]])}function Ne(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=n.match(/^<[^/\s>]*/);if(a){var s=i?Ne(e):e,o=a[0].length;return"".concat(a[0]," ").concat(s,'="').concat(t,'"').concat(n.slice(o))}}function Ue(e){var t=e;function n(e,t,n,i){return"<".concat(Ne(n)).concat(i,"</").concat(Ne(n),">")}function i(e,t){return"".concat(Ne(t),'="')}return t=t.replace(/(<mark tag=)"([^"]*)"([^>]*>[^<]*)(<\/mark>)/g,n).replace(/(\w+)="/g,i).replace(/(<((?!Term)[^>])*)>([^<]*)(<\/[^>]*>)/g,'$1 Term="$3">$3$4'),t}var Ie,Re=n("53ca");
/**
 * docusky.ui.manageDbListSimpleUI.js
 * (URL)
 *
 * (Description)
 * 這是利用 docusky web api 所包裝起來的一份 JavaScript
 * Note: - this component is only tested under Firefox and Chrome
 *       - requires jquery
 *
 * @version
 * 0.01 (May xx 2016)
 * 0.02 (August xx 2016)
 * 0.03 (January 23 2017) fix css class name (adds prefix 'dsw-' to better avoid naming conflicts)
 * 0.04 (March 01 2017) add simple message for upload progress
 * 0.05 (April 23 2017) add hideWidget() and modify some codes to let invoker better use widget functions
 * 0.06 (July 28 2017)  set some functions as "private" methods (and fix some bugs)
 * 0.07 (August 09 2017) open uploadMultipart() method
 * 0.08 (January 28 2017) add enableWidgetEvent(), disableWidgetEvent() to allow db/corpus callback
 * 0.09 (January 30 2018) expose login() and uploadMultipart(), and add with credentials to allow CORS requests
 * 0.10 (May 13 2018) add default 'corpusClick' function
 * 0.11 (Feb 19 2019) add renameDbTitle, getUserProfile function (modify widgetEvents so that the callback func
 *                    has evt in the first arg and this in the second arg)
 * 0.12 (April 01 2019) add error handling and me.Error for the most functions and
 *                      modify the parameter of uploadMultipart()
 * 0.13 (April 04 2019) add functions for user friendship and accessible dbs
 * 0.14 (April 23 2019) add with mechanism on maxResponseTimeout, maxRetryCount, uploadProgressFunc, utility.setStyle, setLoadingIcon
 *                      fix the display of uploadprogressbar
 * 0.15 (May 04 2019) fix hideWidget(), add ownerUsername, and fix server improperly return a non-JSON (should not retry in this case)
 * 0.16 (June 06 2019) remove the dependency of jQuery UI
 * 0.17 (Jan 26 2021) add SessionKey to pass session key via url parameter
 *
 *
 * @copyright
 * Copyright (C) 2016 Hsieh-Chang Tu
 *
 * @license
 *
 */window.navigator.userAgent.indexOf("MSIE ")>0&&alert("抱歉，DocuSky 工具目前只支援 Firefox 與 Chrome");var We=function(e){var t=this;t.package="docusky.ui.manageDbListSimpleUI.js",t.version=.15,t.idPrefix="DbList_",t.utility=null,t.protocol=null,t.urlHostPath=null,t.urlWebApiPath=null,t.urlGetDbListJson=null,t.urlUploadXmlFilesToBuildDbJson=null,t.urlDeleteDbJson=null,t.urlLogin=null,t.urlLogout=null,t.displayname="",t.username="",t.callerEvent=null,t.callerCallback=null,t.initialized=!1,t.includeFriendDb=!1,t.ownerUsername=null,t.dbList=[],t.fileName="",t.fileData="",t.fileSizeLimit=125829120,t.enableRefresh=!0,t.timeoutFunId=null,t.loadingIconWidth=140,t.displayLoadingIcon=!0,t.displayWidget=!0,t.widgetEvents={dbClick:null,corpusAttCntClick:null,corpusClick:function(e,n,i,a){var s=t.urlWebApiPath+"/webpage-search-3in1.php?ownerUsername="+n+"&db="+i+"&corpus="+a;window.open(s,"_blank")},attCntClick:null},t.validEvtKeys=["dbClick","corpusAttCntClick","corpusClick","attCntClick"],t.loginSuccFunc=null,t.loginFailFunc=null,t.Error=null,t.uploadProgressFunc=null,t.maxResponseTimeout=3e5,t.maxRetryCount=10,t.presentRetryCount=0;var n=function(){location.protocol.substr(0,location.protocol.length-1);t.urlHostPath="https://docusky.org.tw/docusky",t.urlWebApiPath=t.urlHostPath+"/webApi",t.urlGetDbListJson=t.urlWebApiPath+"/getDbListJson.php",t.urlUploadXmlFilesToBuildDbJson=t.urlWebApiPath+"/uploadXmlFilesToBuildDbJson.php",t.urlDeleteDbJson=t.urlWebApiPath+"/deleteDbJson.php",t.urlRenameDbTitleJson=t.urlWebApiPath+"/renameDbTitleJson.php",t.urlGetUserProfileJson=t.urlWebApiPath+"/getUserProfileJson.php",t.urlLogin=t.urlWebApiPath+"/userLoginJson.php",t.urlLogout=t.urlWebApiPath+"/userLogoutJson.php",t.urlUserMain=t.urlHostPath+"/docuTools/userMain/",t.displayname="",t.username="",t.uniqueId=t.utility.uniqueId(),t.urlReplaceUserFriendshipJson=t.urlWebApiPath+"/replaceUserFriendshipJson.php",t.urlReplaceUserFriendAccessibleDbJson=t.urlWebApiPath+"/replaceUserFriendAccessibleDbJson.php",t.urlDeleteUserFriendshipJson=t.urlWebApiPath+"/deleteUserFriendshipJson.php",t.urlDeleteUserFriendAccessibleDbJson=t.urlWebApiPath+"/deleteUserFriendAccessibleDbJson.php",t.urlGetUserFriendshipJson=t.urlWebApiPath+"/getUserFriendshipJson.php",t.urlGetUserFriendAccessibleDbJson=t.urlWebApiPath+"/getUserFriendAccessibleDbJson.php";var e=t.idPrefix+"loginContainer"+t.uniqueId,n=t.idPrefix+"loginContainerOverlay"+t.uniqueId,i=t.idPrefix+"closeLoginContainer"+t.uniqueId,a=t.idPrefix+"dsUsername"+t.uniqueId,s=t.idPrefix+"dsPassword"+t.uniqueId,o=t.idPrefix+"loginSubmit"+t.uniqueId,r=t.idPrefix+"closeLoginButton"+t.uniqueId,l=t.idPrefix+"loginMessage"+t.uniqueId,c="<div id='"+e+"' class='dsw-container'><div id='"+n+"' class='dsw-overlay'></div><div class='dsw-titleBar'><table><tr><td class='dsw-titleContainer'><div class='dsw-titlename'>DocuSky Login</div></td><td class='dsw-closeContainer' id='"+i+"'><span class='dsw-btn-close' id='"+r+"'>&#x2716;</span></td></tr></table></div><div class='dsw-containerContent'><table><tr><td class='dsw-td-dslogin dsw-logintitle'>Username:</td><td class='dsw-td-dslogin'><input type='text' class='dsw-userinput' id='"+a+"'/></td></tr><tr><td class='dsw-td-dslogin dsw-logintitle'>Password:</td><td class='dsw-td-dslogin'><input type='password' class='dsw-userinput' id='"+s+"'/></td></tr><tr><td class='dsw-td-dslogin dsw-loginsubmit' colspan='2'><input id='"+o+"' type='submit' value='登入'/></td></tr><tr><td colspan='2' class='dsw-loginmsg' id='"+l+"'></td></tr></table></div></div>";k("html").append(c),k("#"+e).hide(),k("#"+o).click((function(e){t.login(k("#"+a).val(),k("#"+s).val(),t.loginSuccFunc,t.loginFailFunc)})),k("#"+r).click((function(n){k("#"+e).fadeOut(),t.hideWidget()}));var d=t.idPrefix+"dbListContainer"+t.uniqueId,u=t.idPrefix+"dbListContent"+t.uniqueId,p=t.idPrefix+"spanDisplayname"+t.uniqueId,f=t.idPrefix+"dbListImportToBuildDb"+t.uniqueId,m=t.idPrefix+"logoutAnchor"+t.uniqueId,h=t.idPrefix+"DocuSkyLinkAnchor"+t.uniqueId,b=t.idPrefix+"closeDbList"+t.uniqueId,g=t.idPrefix+"uploadXmlFile"+t.uniqueId,w=t.idPrefix+"uploadXmlToBuildDb"+t.uniqueId,v=t.idPrefix+"dbTitleForImport"+t.uniqueId,C=t.idPrefix+"uploadForm"+t.uniqueId,x=t.idPrefix+"uploadProgress"+t.uniqueId,y=t.package+" - Ver "+t.version;c="<div id='"+d+"' class='dsw-container'><div class='dsw-titleBar'><table><tr><td class='dsw-titleContainer'><div class='dsw-titlename' title='"+y+"'>資料庫文獻集列表</div>&nbsp;&nbsp;&nbsp;<span class='dsw-btn-docusky' id='"+h+"'>DocuSky</span></td><td class='dsw-closeContainer'><div class='dsw-btn-close' id='"+b+"'>&#x2716;</div><span class='dsw-btn-logout' id='"+m+"'>Logout</span><span class='dsw-displaynameContainer'><span class='dsw-displayname' id='"+p+"'>"+t.displayname+"</span></span></td></tr></table></div><div id='"+u+"' class='dsw-containerContent'></div><hr width='96%'/><div id='"+f+"' class='dsw-containerContent'><form id='"+C+"' name='uploadForm'><div>上載單份 ThdlExportXml 檔以建構文字資料庫：<input type='file' id='"+g+"' name='importedFiles[]' accept='.xml'></input></div><table class='dsw-uploadfile'><tr><td>資料庫名稱:</td>    <td><input type='text' class='dsw-userinput' id='"+v+"' name='dbTitleForImport' value='Default'></input></td>    <td width='40%'><div class='dsw-uploadprogressbar' id='"+x+"'><div class='dsw-uploadprogressbar-progress'></div></div></td>    <td align='right'><button id='"+w+"' disabled='disabled'>開始上傳</button></td></tr></table></div></form></div>";k("html").append(c),k("#"+d).hide(),k("#"+m).click((function(e){e.preventDefault(),k.ajaxSetup({xhrFields:{withCredentials:!0}});var n=t.urlLogout+(Ie?"?"+Ie:"");k.get(n,(function(e){var n=t.idPrefix+"dbListContainer"+t.uniqueId;0==e.code?(k("#"+n).fadeOut(),alert("Successfully logged out")):(k("#"+n).fadeout(),alert(e.code+": "+e.message))}),"json").fail((function(e,n,i){"200"!=e.status?("404"==e.status||"403"==e.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof failFunc?failFunc():"function"===typeof t.Error?"404"==e.status||"403"==e.status?t.Error("Server Error"):t.Error("Connection Error"):"404"==e.status||"403"==e.status?alert("Server Error"):t.presentRetryCount<t.maxRetryCount?(t.presentRetryCount++,alert("Connection Error")):alert("Please check your Internet connection and refresh this page.")):alert("Server response seems not a valid JSON")}))})),k("#"+h).click((function(e){var n=t.urlUserMain+Ie?"?"+Ie:"";window.open(n)})),k("#"+b).click((function(e){t.hideWidget()})),k("#"+w).click((function(e){e.preventDefault(),k("#"+j).css({top:e.clientY,left:e.clientX}),k("#"+j).show();var n=t.urlUploadXmlFilesToBuildDbJson;n+=Ie?"?"+Ie:"";var i=k("#"+C).serializeArray(),a=k("#"+g).attr("name");i.file={value:t.fileData,filename:t.fileName,name:a},t.uploadMultipart(n,i)}));var j=t.idPrefix+"loadingContainer"+t.uniqueId,E=t.idPrefix+"loadingSign"+t.uniqueId,S=t.idPrefix+"workingProgressId"+t.uniqueId;c="<div id='"+j+"' style='position:absolute; border:3px grey solid; border-radius:6px; background-color:white; z-index: 1003;'><div id='"+E+"'><img src='"+t.urlWebApiPath+"/images/loading-circle.gif' width='140' border='0'/></div><div id='"+S+"' style='position:absolute; top:60px; width:100%; text-align:center;;'></div></div>";k("html").append(c),k("#"+j).hide(),t.initialized=!0};t.login=function(e,n,i,a){var s={dsUname:e,dsPword:n};k.ajaxSetup({xhrFields:{withCredentials:!0}}),k.post(t.urlLogin,s,(function(e){var n=t.idPrefix+"loginMessage"+t.uniqueId,s=t.idPrefix+"loginContainer"+t.uniqueId;0==e.code?(k("#"+n).empty(),k("#"+s).fadeOut(),"function"===typeof i?i(e.message):t.manageDbList(t.callerEvent,t.callerCallback),Ie=e.message):(console.error("Login Error"),"function"===typeof a?a(e):"function"===typeof t.Error?t.Error("Login Error"):(k("#"+s).show(),k("#"+n).html(e.code+": "+e.message)))}),"json").fail((function(s,o,r){if("200"!=s.status)if("404"==s.status||"403"==s.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof a)a();else if("function"===typeof t.Error)"404"==s.status||"403"==s.status?t.Error("Server Error"):t.Error("Connection Error");else{var l=t.idPrefix+"loginMessage"+t.uniqueId,c=t.idPrefix+"loginContainer"+t.uniqueId;if(k("#"+c).show(),"404"==s.status||"403"==s.status)k("#"+l).html("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,k("#"+l).html("Connection Error");var d=function(){t.login(e,n,i,a)};setTimeout(d,3e3)}else k("#"+l).html("Please check your Internet connection and refresh this page.")}else alert("Server response seems not a valid JSON")}))},t.hideWidget=function(e){if(!1===e&&(t.displayWidget=!0),void 0===e||!t.displayWidget){var n=t.idPrefix+"dbListContainer"+t.uniqueId;k("#"+n).hide();var i=t.idPrefix+"loginContainer"+t.uniqueId;k("#"+i).hide(),clearTimeout(t.timeoutFunId),t.enableRefresh=!1}},t.hideLoadingIcon=function(e){t.displayLoadingIcon=!1===e},t.enableWidgetEvent=function(e,n){!1!==t.validEvtKeys.indexOf(e)&&"function"===typeof n&&(t.widgetEvents[e]=n)},t.disableWidgetEvent=function(e){!1!==t.validEvtKeys.indexOf(e)&&(t.widgetEvents[e]=null)},t.setLoadingIcon=function(e){var n=t.idPrefix+"loadingSign"+t.uniqueId;k("#"+n+" img").attr("src",e)};var i=function(e,n){for(var i=t.dbList,s=!1,o=t.idPrefix+"contentTable"+t.uniqueId,r=t.idPrefix+"dbListContent"+t.uniqueId,l=t.idPrefix+"uploadXmlFile"+t.uniqueId,c="<table id='"+o+"' class='dsw-tableDbCorpuslist'>",d=0;d<i.length;d++){var u=i[d]["username"]||t.username,p=i[d]["ownerUsername"]||t.username,f=i[d]["db"],m=i[d]["dbStatus"];0!=m&&9!=m&&(s=!0);for(var h=i[d]["corpusList"],b=i[d]["corpusAttCntList"],g=h.split(";"),w=b.split(";"),v="<div>",C=0;C<g.length;C++){C>0&&(v+=" ‧ ");var x=g[C],y=w[C],j="",E="x-db='".concat(f,"' x-corpus='").concat(x,"' x-ownerUsername='").concat(p,"'");if(t.widgetEvents.corpusAttCntClick)var S="<span class='dsw-corpusAttCntClick' "+E+">"+x+(y>0?" ["+y+"]":"")+"</span>";else{S=t.widgetEvents.corpusClick?"<span class='dsw-corpusClick' "+E+">"+x+"</span>":x;y>0&&(j=t.widgetEvents.attCntClick?"<span class='dsw-attCntClick' "+E+">"+x+"'> ["+y+"]</span>":"["+y+"]")}v+="<span class='dsw-dbList-corpusnames-corpusname'>"+S+j+"</span>"}v+="</div>";var T=t.widgetEvents.dbClick?"<span class='dsw-dbClick' x-db='"+f+"'>"+f+"</span>":f,_=u==p?"<a class='deleteDb' href='"+t.urlDeleteDbJson+"?db="+f+"'>刪除</a>":"<span style='background-color:darkred;color:white;'>"+p+"</span>";c+="<tr class='dsw-tr-dbcorpuslist'><td class='dsw-td-dbList dsw-td-dbList-dbname'>"+T+"</td><td class='dsw-td-dbList dsw-td-dbList-corpusnames'>"+v+"</td><td class='dsw-td-dbList dsw-td-dbList-delete'>"+_+"</td>"}c+="</table>",k("#"+r).html(c);k("#"+o).width();k("span.dsw-dbClick").on("click",(function(e){t.hideWidget(),"function"===typeof t.widgetEvents.dbClick&&t.widgetEvents.dbClick(e,k(this).attr("x-ownerUsername"),k(this).attr("x-db"))})),k("span.dsw-corpusAttCntClick").on("click",(function(e){t.hideWidget(),"function"===typeof t.widgetEvents.corpusAttCntClick&&t.widgetEvents.corpusAttCntClick(e,k(this).attr("x-ownerUsername"),k(this).attr("x-db"),k(this).attr("x-corpus"))})),k("span.dsw-corpusClick").on("click",(function(e){t.hideWidget(),"function"===typeof t.widgetEvents.corpusClick&&t.widgetEvents.corpusClick(e,k(this).attr("x-ownerUsername"),k(this).attr("x-db"),k(this).attr("x-corpus"))})),k("span.dsw-attCntClick").on("click",(function(e){t.hideWidget(),"function"===typeof t.widgetEvents.attCntClick&&t.widgetEvents.attCntClick(e,k(this).attr("x-ownerUsername"),k(this).attr("x-db"),k(this).attr("x-corpus"))}));var L=k("#"+o).height();k("#"+r).height(Math.min(280,L)),k("#"+l).change((function(e){var n=this.files;t.fileName=n[0].name;var i=n[0].size;if(i>this.fileSizeLimit)return alert("Error\nThe size of "+this.fileName+" ("+i+") exceeds upload limit\nUpload limit size: "+this.fileSizeLimit),void(this.fileData="");var s=t.idPrefix+"loadingContainer"+t.uniqueId,o=t.idPrefix+"uploadXmlToBuildDb"+t.uniqueId;k("#"+s).css({top:k("#"+r).position().top+k("#"+r).height()/2,left:k("#"+r).position().left+k("#"+r).width()/2}),k("#"+s).show(),a(n[0]).done((function(e){t.fileData=e,k("#"+s).hide(),k("#"+o).prop("disabled",!1)}))})),k(".deleteDb").click((function(e){e.preventDefault();this.href;var n=this.href.match(/db=([^&]+)/),i=confirm("確定要刪除資料庫：「"+decodeURIComponent(n[1]+"」?"));i&&t.deleteDb(n[1])}));var O=t.idPrefix+"dbListContainer"+t.uniqueId;t.utility.dragElement(k("#"+O)[0],k("#"+O+" .dsw-titleBar")[0]),t.enableRefresh&&s&&(t.timeoutFunId=setTimeout((function(){t.manageDbList(e,null)}),15e3))};t.deleteDb=function(e,i,a){t.initialized||n();var s=t.urlDeleteDbJson+"?db="+e;s+=Ie?"&"+Ie:"",k.ajaxSetup({xhrFields:{withCredentials:!0}}),k.get(s,(function(e){if(0==e.code)"function"===typeof i?i():alert(e.message);else if(101==e.code){k("#"+loginContainerId).show();var n=k("#"+loginContainerId);n.width(),n.height();n.css({top:"40px",left:"80px"}),n.show()}else console.error("Server Error"),"function"===typeof a?a():"function"===typeof t.Error?t.Error("Server Error"):alert("Error: "+e.code+"\n"+e.message)}),"json").fail((function(n,s,o){if("200"!=n.status)if("404"==n.status||"403"==n.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof a)a();else if("function"===typeof t.Error)"404"==n.status||"403"==n.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==n.status||"403"==n.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var r=function(){t.deleteDb(e,i,a)};setTimeout(r,3e3)}else alert("Please check your Internet connection and refresh this page.");else alert("Server response seems not a valid JSON")}))},t.renameDbTitle=function(e,i,a,s){t.initialized||n();var o=t.urlRenameDbTitleJson+"?oldDbTitle="+e+"&newDbTitle="+i;o+=Ie?"&"+Ie:"",k.ajaxSetup({xhrFields:{withCredentials:!0}}),k.get(o,(function(e){if(0==e.code)"function"===typeof a?a():alert(e.message);else if(101==e.code){k("#"+loginContainerId).show();var n=k("#"+loginContainerId);n.width(),n.height();n.css({top:"40px",left:"80px"}),n.show()}else console.error("Server Error"),"function"===typeof s?s():"function"===typeof t.Error?t.Error("Server Error"):alert("Error: "+e.code+"\n"+e.message)}),"json").fail((function(n,o,r){if("200"!=n.status)if("404"==n.status||"403"==n.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof s)s();else if("function"===typeof t.Error)"404"==n.status||"403"==n.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==n.status||"403"==n.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var l=function(){t.renameDbTitle(e,i,a,s)};setTimeout(l,3e3)}else alert("Please check your Internet connection and refresh this page.");else alert("Server response seems not a valid JSON")}))},t.getUserProfile=function(e,i,a){t.initialized||n();var s=t.urlGetUserProfileJson+(Ie?"?"+Ie:"");k.ajaxSetup({xhrFields:{withCredentials:!0}}),k.get(s,(function(n){if(e){var s=t.idPrefix+"loadingContainer"+t.uniqueId;k("#"+s).hide()}if(0==n.code)"function"===typeof i?i(n.message):alert("USER PROFILE:\n"+JSON.stringify(n.message));else if(101==n.code){var o=t.idPrefix+"loginContainer"+t.uniqueId;k("#"+o).show();var r=k("#"+o);r.width(),r.height();r.css({top:"40px",left:"80px"}),r.show()}else console.error("Server Error"),"function"===typeof a?a():"function"===typeof t.Error?t.Error("Server Error"):alert("Error: "+n.code+"\n"+n.message)}),"json").fail((function(n,s,o){if("200"!=n.status){if("404"==n.status||"403"==n.status?console.error("Server Error"):console.error("Connection Error"),e){var r=t.idPrefix+"loadingContainer"+t.uniqueId;k("#"+r).show();var l=t.idPrefix+"workingProgressId"+t.uniqueId;"404"==n.status||"403"==n.status?k("#"+l).html("<font size='3.5'>Server <br> Error</font>"):k("#"+l).html("<font size='3.5'>Unstable <br> network</font>")}if("function"===typeof a)a();else if("function"===typeof t.Error)"404"==n.status||"403"==n.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==n.status||"403"==n.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var c=function(){t.getUserProfile(e,i,a)};setTimeout(c,3e3)}else alert("Please check your Internet connection and refresh this page.")}else alert("Server response seems not a valid JSON")}))},t.manageDbList=function(e,a,s){t.initialized||n(),t.callerEvent=e,t.callerCallback=a,t.enableRefresh=!0;var o=Math.max(document.documentElement.clientWidth,window.innerWidth||0),r=Math.max(document.documentElement.clientHeight,window.innerHeight||0),l=t.idPrefix+"loginContainer"+t.uniqueId,c=(t.idPrefix,t.uniqueId,t.idPrefix,t.uniqueId,t.includeFriendDb?"&includeFriendDb=1":""),d="USER",u=t.urlGetDbListJson+"?target="+d+c;u+=Ie?"&"+Ie:"",k.ajaxSetup({xhrFields:{withCredentials:!0}}),k.get(u,(function(n){if(e){var a=t.idPrefix+"loadingContainer"+t.uniqueId;k("#"+a).hide()}if(0==n.code){if(t.dbList=n.message,e){var c=t.idPrefix+"dbListContainer"+t.uniqueId,d=k("#"+c),u=d.width(),p=d.height(),f=Math.max(0,e.pageX-40+u-o),m=Math.max(10,e.pageX-f-40),h=(Math.max(0,e.pageY+p+15-r),e.pageY+5);d.css({top:h+"px",left:m+"px"}),k("#"+c).show()}t.getUserProfile(null,(function(e){t.displayname=e.display_name;var n=t.idPrefix+"spanDisplayname"+t.uniqueId;k("#"+n).html(t.displayname)})),i(e),t.hideWidget(!t.displayWidget),"function"===typeof t.callerCallback&&t.callerCallback()}else if(101==n.code)if(e){k("#"+l).show();d=k("#"+l),u=d.width(),p=d.height(),f=Math.max(0,e.pageX-40+u-o),m=Math.max(10,e.pageX-f-40),Math.max(0,e.pageY+p+15-r),h=e.pageY+5;d.css({top:h+"px",left:m+"px"}),d.show()}else{k("#"+l).show();d=k("#"+l),u=d.width(),p=d.height(),f=Math.max(0,u-40-o),m=Math.max(10,f-40),Math.max(0,p+15-r),h=5;d.css({top:h+"px",left:m+"px"}),d.show()}else console.error("Server Error"),"function"===typeof s?(t.hideWidget(!t.displayWidget),s()):"function"===typeof t.Error?(t.hideWidget(!t.displayWidget),t.Error("Server Error")):alert("Error: "+n.code+"\n"+n.message)}),"json").fail((function(n,i,r){if("200"!=n.status){if("404"==n.status||"403"==n.status?console.error("Server Error"):console.error("Connection Error"),e){var l=t.idPrefix+"loadingContainer"+t.uniqueId,c=k("#"+l).width(),d=(k("#"+l).height(),Math.max(0,e.pageX-40+c-o)),u=Math.max(10,e.pageX-d-40),p=e.pageY+5;k("#"+l).css({top:p+"px",left:u+"px"}),k("#"+l).show();var f=t.idPrefix+"workingProgressId"+t.uniqueId;"404"==n.status||"403"==n.status?k("#"+f).html("<font size='3.5'>Server <br> Error</font>"):k("#"+f).html("<font size='3.5'>Unstable <br> network</font>")}if("function"===typeof s)t.hideWidget(!t.displayWidget),s();else if("function"===typeof t.Error)t.hideWidget(!t.displayWidget),"404"==n.status||"403"==n.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==n.status||"403"==n.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++;var m=function(){t.manageDbList(e,a,s)};setTimeout(m,3e3)}else alert("Please check your Internet connection and refresh this page.")}else alert("Server response seems not a valid JSON")}))},t.getUserFriendship=function(e,n,i){var a=t.urlGetUserFriendshipJson,s=e.friendGenre||!1,o=e.friendTags||!1,r="";r+=s?"friendGenre="+encodeURIComponent(s):"",r+=o?(""!=r?"&":"")+"friendTags="+encodeURIComponent(o):"",k.ajax({method:"GET",url:a,data:r}).done((function(e){0==e.code?"function"===typeof n?n(e.message):alert("GetUserFriendship:\n"+JSON.stringify(e.message)):(console.error("Server Error"),"function"===typeof i?i(e):"function"===typeof t.Error?t.Error("Server Error"):alert("getUserFriendship: "+e.message))})).fail((function(a,s,o){if("404"==a.status||"403"==a.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof i)i();else if("function"===typeof t.Error)"404"==a.status||"403"==a.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==a.status||"403"==a.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var r=function(){t.getUserFriendship(e,n,i)};setTimeout(r,3e3)}else alert("Please check your Internet connection and refresh this page.")}))},t.getUserFriendAccessibleDb=function(e,n,i){var a=t.urlGetUserFriendAccessibleDbJson,s=e.friendUsernames||!1,o="";o+=s?"friendUsernames="+encodeURIComponent(s):"",k.ajax({method:"GET",url:a,data:o}).done((function(e){0==e.code?"function"===typeof n?n(e.message):alert("getUserFriendAccessibleDb:\n"+JSON.stringify(e.message)):(console.error("Server Error"),"function"===typeof i?i(e):"function"===typeof t.Error?t.Error("Server Error"):alert("getUserFriendAccessibleDb: "+e.message))})).fail((function(a,s,o){if("404"==a.status||"403"==a.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof i)i();else if("function"===typeof t.Error)"404"==a.status||"403"==a.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==a.status||"403"==a.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var r=function(){t.getUserFriendAccessibleDb(e,n,i)};setTimeout(r,3e3)}else alert("Please check your Internet connection and refresh this page.")}))},t.replaceUserFriendship=function(e,n,i){var a=t.urlReplaceUserFriendshipJson,s=e.friendUsernames||!1,o=e.friendGenre||!1,r=e.friendTags||!1,l="";l+=s?"friendUsernames="+encodeURIComponent(s):"",l+=o?(""!=l?"&":"")+"friendGenre="+encodeURIComponent(o):"",l+=r?(""!=l?"&":"")+"friendTags="+encodeURIComponent(r):"",k.ajax({method:"GET",url:a,data:l}).done((function(e){0==e.code?"function"===typeof n?n(e.message):alert("replaceUserFriendship:\n"+JSON.stringify(e.message)):(console.error("Server Error"),"function"===typeof i?i(e):"function"===typeof t.Error?t.Error("Server Error"):alert("replaceUserFriendship: "+e.message))})).fail((function(a,s,o){if("404"==a.status||"403"==a.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof i)i();else if("function"===typeof t.Error)"404"==a.status||"403"==a.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==a.status||"403"==a.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var r=function(){t.replaceUserFriendship(e,n,i)};setTimeout(r,3e3)}else alert("Please check your Internet connection and refresh this page.")}))},t.replaceUserFriendAccessibleDb=function(e,n,i){var a=t.urlReplaceUserFriendAccessibleDbJson,s=e.friendAccessibleDb,o="friendAccessibleDb="+JSON.stringify(s);k.ajax({method:"POST",url:a,data:o}).done((function(e){0==e.code?"function"===typeof n?n(e.message):alert("replaceUserFriendAccessibleDb:\n"+JSON.stringify(e.message)):(console.error("Server Error"),"function"===typeof i?i(e):"function"===typeof t.Error?t.Error("Server Error"):alert("replaceUserFriendAccessibleDb: "+e.message))})).fail((function(a,s,o){if("404"==a.status||"403"==a.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof i)i();else if("function"===typeof t.Error)"404"==a.status||"403"==a.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==a.status||"403"==a.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var r=function(){t.replaceUserFriendAccessibleDb(e,n,i)};setTimeout(r,3e3)}else alert("Please check your Internet connection and refresh this page.")}))},t.deleteUserFriendship=function(e,n,i){var a=t.urlDeleteUserFriendshipJson,s=e.friendUsernames||!1,o="";o+=s?"friendUsernames="+encodeURIComponent(s):"",k.ajax({method:"POST",url:a,data:o}).done((function(e){0==e.code?"function"===typeof n?n(e.message):alert("deleteUserFriendship:\n"+JSON.stringify(e.message)):(console.error("Server Error"),"function"===typeof i?i(e):"function"===typeof t.Error?t.Error("Server Error"):alert("deleteUserFriendship: "+e.message))})).fail((function(a,s,o){if("404"==a.status||"403"==a.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof i)i();else if("function"===typeof t.Error)"404"==a.status||"403"==a.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==a.status||"403"==a.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var r=function(){t.deleteUserFriendship(e,n,i)};setTimeout(r,3e3)}else alert("Please check your Internet connection and refresh this page.")}))},t.deleteUserFriendAccessibleDb=function(e,n,i){var a=t.urlDeleteUserFriendAccessibleDbJson,s=e.friendAccessibleDb,o="friendAccessibleDb="+JSON.stringify(s);k.ajax({method:"POST",url:a,data:o}).done((function(e){0==e.code?"function"===typeof n?n(e.message):alert("deleteUserFriendAccessibleDb:\n"+JSON.stringify(e.message)):(console.error("Server Error"),"function"===typeof i?i(e):"function"===typeof t.Error?t.Error("Server Error"):alert("deleteUserFriendAccessibleDb: "+e.message))})).fail((function(a,s,o){if("404"==a.status||"403"==a.status?console.error("Server Error"):console.error("Connection Error"),"function"===typeof i)i();else if("function"===typeof t.Error)"404"==a.status||"403"==a.status?t.Error("Server Error"):t.Error("Connection Error");else if("404"==a.status||"403"==a.status)alert("Server Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var r=function(){t.deleteUserFriendAccessibleDb(e,n,i)};setTimeout(r,3e3)}else alert("Please check your Internet connection and refresh this page.")}))};var a=function(e){var t=new FileReader,n=k.Deferred(),i=n.promise();return t.onload=function(e){n.resolve(e.target.result)},t.onprogress=t.onloadstart=function(e){n.notify(e)},t.onerror=t.onabort=function(e){n.reject(e)},i.abort=function(){return t.abort.apply(t,arguments)},t.readAsText(e,"UTF-8"),i};t.uploadMultipart=function(e,n,i,a){var o=null,r=null,l=null;n&&"function"!==typeof n?(o=n,r=i,l=a):(o=e,r=n,l=i);var c=t.idPrefix+"workingProgressId"+t.uniqueId;k("#"+c).html("");var d=s(o);k.ajax({url:t.urlUploadXmlFilesToBuildDbJson,data:d.data,processData:!1,type:"post",timeout:t.maxResponseTimeout,xhrFields:{withCredentials:!0},crossDomain:!0,contentType:"multipart/form-data; boundary="+d.myBoundary,xhr:function(){var e=k.ajaxSettings.xhr();return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var n=e.loaded||e.position,i=n/e.total*100,a=Math.ceil(i),s=100==a?" ... waiting for server response":"",o=t.idPrefix+"uploadProgress"+t.uniqueId;k("#"+o+" .dsw-uploadprogressbar-progress").text(a+"%"+s).css("width",i+"%"),"function"===typeof t.uploadProgressFunc&&t.uploadProgressFunc(a)}}),!1),e},success:function(e,n,i){var a=t.idPrefix+"loadingContainer"+t.uniqueId;k("#"+a).hide(),0==e.code?"function"===typeof r?r(e):(alert(e.message),t.manageDbList(t.callerEvent,null)):(console.error("Server Error"),"function"===typeof l?l():"function"===typeof t.Error?t.Error("Server Error"):alert("Error: "+e.code+"\n"+e.message));var s=t.idPrefix+"uploadProgress"+t.uniqueId;k("#"+s).hide()},error:function(s,o,r){var c=t.idPrefix+"uploadProgress"+t.uniqueId;k("#"+c).hide();var d=t.idPrefix+"loadingContainer"+t.uniqueId;if(k("#"+d).hide(),r)console.error(r),alert(r),"function"===typeof l?l(r):"function"===typeof t.Error&&t.Error("Server Error");else if(console.error("Connection Error"),"function"===typeof l)l();else if("function"===typeof t.Error)t.Error("Connection Error");else if(t.presentRetryCount<t.maxRetryCount){t.presentRetryCount++,alert("Connection Error");var u=function(){t.uploadMultipart(e,n,i,a)};setTimeout(u,3e3)}else alert("Please check your Internet connection and refresh this page.")}});var u=t.idPrefix+"uploadProgress"+t.uniqueId;k("#"+u).find(".dsw-uploadprogressbar-progress").text("").css("width","0%").end().show()};var s=function(e){var t,n=[];for(var i in t=k.md5?k.md5((new Date).valueOf()):(new Date).valueOf(),t="(-----------docusky:"+t+")",e)"file"==i?n.push("--"+t+'\r\nContent-Disposition: form-data; name="'+e[i].name+'"; filename="'+e[i].filename+'"\r\nContent-Type: application/octet-stream\r\nContent-Transfer-Encoding: binary\r\n\r\n'+e[i].value):n.push("--"+t+'\r\nContent-Disposition: form-data; name="'+e[i].name+'"\r\n\r\n'+e[i].value);return{myBoundary:t,data:n.join("\r\n")+"\r\n--"+t+"--"}};t.scriptPath=(new Error).stack.match(/(((?:http[s]?)|(?:file)):\/\/[\/]?([^\/]+)\/((.+)\/)?)([^\/]+\.js):/)[1],t.utility=Be,t.initialized||n()},Be={getUrlParameterVarValue:function(e,t){var n=e.indexOf("?");if(-1==n)return"";var a=e.substr(n+1).split("&");for(i=0;i<a.length;i++){var s=a[i].split("=");if(s[0]===t)return void 0===s[1]||s[1]}return""},basename:function(e){return e.replace(/.*[/]/,"")},dirname:function(e){return e.match(/(.*)[/]/)[1]},uniqueId:function(){var e=0;return function(){return"_"+e++}}(),getDateStr:function(e,t){"undefined"==typeof t&&(t="");var n=("0"+(e.getMonth()+1)).slice(-2),i=("0"+e.getDate()).slice(-2),a=e.getFullYear()+t+n+t+i;return a},displayJson:function(e){var t=JSON.stringify(e,null,"\t");alert(t)},dragElement:function(e,t){var n=0,i=0,a=0,s=0;function o(e){e=e||window.event,e.preventDefault(),a=e.clientX,s=e.clientY,document.onmouseup=l,document.onmousemove=r}function r(t){t=t||window.event,t.preventDefault(),n=a-t.clientX,i=s-t.clientY,a=t.clientX,s=t.clientY,e.style.top=e.offsetTop-i+"px",e.style.left=e.offsetLeft-n+"px"}function l(){document.onmouseup=null,document.onmousemove=null}t?t.onmousedown=o:e.onmousedown=o},setStyle:function(e){"object"!==Object(Re["a"])(e)&&(e={}),"frameBackgroundColor"in e&&(k("div.dsw-container").css("border",e.frameBackgroundColor+" solid 3px"),k("div.dsw-titleBar").css("background-color",e.frameBackgroundColor)),"frameColor"in e&&k("div.dsw-titleBar").css("color",e.frameColor),"contentBackgroundColor"in e&&k("div.dsw-container").css("background-color",e.contentBackgroundColor)},includeJs:function(e){var t=document.createElement("script");t.src=e,t.type="text/javascript",t.defer=!0,document.getElementsByTagName("head").item(0).appendChild(t)}};k("head").append('<style id="dsw-simplecomboui">div.dsw-container { position:absolute; border:#4F4F4F solid 3px; background-color:#EFEFEF; border-radius:4px; display:inline-block; font-family: "Arial","MingLiU"; font-size: 16px; z-index:1001 }div.dsw-titleBar { background-color:#4F4F4F; color:white; z-index:1001; padding: 6px; line-height: 16px; }div.dsw-containerContent { padding: 6px; overflow-x:hidden; overflow-y:auto; font-size:medium; z-index:1001 }.dsw-titleBar table,.dsw-containerContent table { width: 100%; line-height:1.3em; border-collapse: collapse; border-spacing:0; }table.dsw-tableDbCorpuslist { width:100%; margin-right: 16px; border-collapse: collapse; border-spacing: 0; font-size:medium; line-height:1.3em; color:#2F2F3F; }tr.dsw-tr-dbcorpuslist:nth-child(even) { background: #DFDFDF; line-height:1.3em; }tr.dsw-tr-dbcorpuslist:nth-child(odd)  { background: #FFFFFF; line-height:1.3em; }.dsw-titleContainer { width: 60%; padding: 0; }.dsw-closeContainer { position: relative; text-align: right; direction: rtl; padding: 0; }.dsw-titlename { display: inline-block; line-height: 16px; white-space: nowrap; }.dsw-btn-docusky { position: absolute; color:#2F2F2F; background-color:#EFEFEF; border-radius: 3px; font-size: 0.75rem; line-height: 0.75rem; padding: 4px; margin: 0 24px 0 0; cursor: pointer; }.dsw-btn-docusky:hover { background-color:#BFBFBF; color:#96438A; }.dsw-btn-docusky:active { background-color:#BFBFBF; color:#96438A; }.dsw-btn-close { display: inline-block; line-height: 16px; cursor: pointer; }.dsw-btn-close:hover { background-color:#BFBFBF; color:#96438A; }.dsw-btn-close:active { background-color:#BFBFBF; color:#96438A; }.dsw-td-dbcorpuslist { vertical-align: middle; padding: 0.25rem;}.dsw-td-dbcorpuslist-num { text-align: right;}.dsw-displaynameContainer { display: inline-block; width: 50px; white-space: nowrap; overflow: visible; margin: 0 72px 0 0; }.dsw-displayname { display: inline-block; direction: ltr; }.dsw-btn-logout { position: absolute; right: 0; top: -2px; color:#2F2F2F; background-color:#EFEFEF; border-radius: 3px; font-size: 0.75rem; line-height: 0.75rem; padding: 4px; margin: 0 24px 0 0; cursor: pointer; }.dsw-btn-logout:hover { background-color:#BFBFBF; color:#96438A; }.dsw-btn-logout:active { background-color:#BFBFBF; color:#96438A; }.dsw-overlay { display: none; position: absolute; background-color: #AAAAAA; opacity: 0.5; z-index: 1002; height: 100%; width: 100%; }input[type="text"].dsw-userinput,input[type="password"].dsw-userinput { box-sizing: content-box; padding: 2px 8px; border: 1px solid grey; border-radius: 2px; font-size: 14px; height: 20px; width: 150px; }.dsw-td-dslogin { padding: 0; height: 1.75rem; vertical-align: middle; }.dsw-logintitle { padding-right: 6px; }.dsw-loginsubmit { direction: rtl; }.dsw-loginmsg { padding: 0; color: red; font-size: 12px; font-weight: bold; }table.dsw-filenameList { width: 100%; margin-right: 16px; border-collapse: collapse; border-spacing: 0; line-height: 1.25; }.dsw-filenameList td { padding: 0.25rem; vertical-align: top; white-space: nowrap; }.dsw-filenameList-id { text-align: right; }.dsw-filename-download,.dsw-filename.delete { text-align: center; }.dsw-filenameList-category,.dsw-filenameList-path { text-align: left; overflow-x: hidden; text-overflow: ellipsis; }.dsw-filenameList-id {}.dsw-filenameList-download,.dsw-filenameList-delete { width: 45px; max-width: 45px; text-align: center; }.dsw-filenameList-category { font-weight: bold; min-width: 120px; max-width: 150px; }.dsw-filenameList-path { min-width: 450px; max-width: 550px; }.table.dsw-uploadfile{ width: 100%; border-collapse: collapse; border-spacing: 0; }.dsw-uploadfile td { padding: 0; }.dsw-td-dbList { padding: 0.25rem; }.dsw-td-dbList-dbname,.dsw-td-dbList-corpusnames{ text-align:left; border:1px solid #5C5C5C; }.dsw-td-dbList-delete{ text-align: center;  border:1px solid #5C5C5C; }.dsw-td-dbList-dbname{ font-weight:600; min-width: 100px; max-width:180px; word-wrap: break-word; word-break: break-all; }.dsw-td-dbList-corpusnames{ min-width: 450px; max-width: 550px; }.dsw-td-dbList-delete{ min-width:40px; max-width: 60px; white-space: nowrap; }.dsw-dbList-corpusnames-corpusname { display: inline-block; vertical-align: middle; white-space: nowrap; max-width: 250px; overflow-x: hidden; text-overflow: ellipsis; }.dsw-uploadprogressbar { display: none; box-sizing: border-box; height: 20px; width: 100%; margin: 0; padding: 0; border: 1px solid #515F6B; border-radius: 3px; overflow: hidden; background-color: #AFB9C3; }.dsw-uploadprogressbar-progress { display: block; height: 100%; margin: 0; padding: 0; border: 0; background-color: #4C93D4; text-align: center; color: white; white-space: nowrap; }.dsw-dbClick { cursor:pointer; text-decoration:underline; color:blue; }.dsw-corpusAttCntClick { cursor:pointer; text-decoration:underline; color:blue; }.dsw-corpusClick { cursor:pointer; text-decoration:underline; color:blue; }.dsw-attCntClick { cursor:pointer; text-decoration:underline; color:blue; }</style>');var ze,Xe=new We,qe=n("2c4e"),Je=n("5c8a"),$e={name:"App",components:{BookChildContent:K,HotTable:Te["a"],Multiselect:Le.a,TagEdit:ie,GetTableContent:ue,SimpleXml:we,draggable:Se.a,FileOrder:je},computed:{xml:function(){return this.showXmlString.replace(/\n/g,"")},dragOptions:function(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}},data:function(){return{activeStep:0,showSocial:!1,isAnimated:!0,isRounded:!0,isStepsClickable:!1,hasNavigation:!0,customNavigation:!1,isProfileSuccess:!1,prevIcon:"chevron-left",nextIcon:"chevron-right",labelPosition:"left",mobileMode:"minimalist",stepClass:"step-class",isInputDataValid:!0,isMetadataComplete:!0,isKeepFormat:"Yes",isAddHyperlink:!0,urlFieldHint:"",isInputEmpty:!1,wikiUrls:"",wikiContents:"",filename:"",isSeperateByParagraph:"default",isAddExtendedLinks:!1,isAddMenuToDownload:!1,extendedLinks:[],confirmLinks:[],sourceWord:"",corpusName:"",corpusDefault:"文獻集名稱：預設「我的資料集」",tableOfContents:[],tempMenuList:[],treeShowMenu:[],sortValueBy:"INDEX",valueConsistsOf:"ALL",tempSelectMenu:[],selectedBookMenuPool:[],menuIndexCount:0,refLinks:[],selectRefLinks:[],wikiContentSnippet:"",isCheckBook:!1,kidsWord:"",testModal:!0,isImageModalActive:!1,wikiContentWaitCut:[],splitCompleteWikiContents:[],testSelCut:1,selectMetaDataColumns:p,selectedMetaDataColumns:[],licenseKey:"non-commercial-and-evaluation",isEditMetadata:!1,getSplitSheet:[],colHeaders:f,columns:m,isEditMetaTable:!1,fileNameMeta:"file",corpusNameMeta:"我的文獻集",uploadFileName:"我的文獻集",wikiTags:[],wikiTagOptions:[{tagLabel:"PersonName",tagName:"PersonName"},{tagLabel:"LocName",tagName:"LocName"},{tagLabel:"Date",tagName:"Date"},{tagLabel:"Office",tagName:"Office"}],showXmlString:"",isKeepHyperLink:!1,isCutFileByPara:!1,isOpenUploadModal:!1,account:"",password:"",isUploadable:!1,widget:Xe,drag:!1,isEditFileOrder:!1}},methods:{undoHot:function(){this.$refs.hotTableComponent.hotInstance.undo()},redoHot:function(){this.$refs.hotTableComponent.hotInstance.redo()},deleteBook:function(e){var t=e.bookOrder,n=e.chapOrder;this.selectedBookMenuPool.length&&this.selectedBookMenuPool[t].menu.splice(n,1)},deleteAllTag:function(e){this.splitCompleteWikiContents.forEach((function(t){t.doc_content=t.doc_content.replace(new RegExp(String.raw(ze||(ze=Object(u["a"])(['<mark tag="','">([^<]*)</mark>'])),e.tagName),"g"),"$1")}))},addContentTag:function(e){var t={tagLabel:e,tagName:"Udef_".concat(e)};this.wikiTagOptions.push(t),this.wikiTags.push(t)},cleanUrlField:function(){this.wikiUrls="",this.urlFieldHint="",this.isInputEmpty=!1,this.wikiDocuments=[]},getQueryResult:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=this.sourceWord){e.next=2;break}return e.abrupt("return");case 2:return this.refLinks=[],this.selectRefLinks=[],this.confirmLinks=[],this.tableOfContents=[],this.selectedBookMenuPool=[],e.next=9,S(this.sourceWord);case 9:this.refLinks=e.sent,this.isAddExtendedLinks=!0;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),addSelectedMenuItem:function(e){this.selectedBookMenuPool.push(e)},getRefLink:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.refLinks=[],e.next=3,j(this.extendedLinks[t]);case 3:n=e.sent,this.refLinks.concat(n);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),openSelectBookList:function(){this.selectedBookMenuPool.sort((function(e,t){return e.index-t.index})),this.isCheckBook=!0},openEditTable:function(){this.isEditMetaTable=!0,this.$nextTick((function(){this.$refs.multiselect.activate()}))},handleWikiCutObj:function(e){this.wikiContentWaitCut.push(e),e.isUrlAllow&&!this.wikiTagOptions.find((function(e){return"Wiki_url"===e.tagLabel}))&&(this.wikiTagOptions.push({tagLabel:"Wiki_url",tagName:"Udef_wiki"}),this.wikiTags.push({tagLabel:"Wiki_url",tagName:"Udef_wiki"}))},handleWikiTag:function(e){this.splitCompleteWikiContents[e.index].doc_content=e.newContent},splitWikiContents:function(){var e=this;this.$refs.contentTable.forEach((function(t){t.isViewed||(e.isCutFileByPara&&(t.paragraphCutWay=2),e.isKeepHyperLink&&(t.isUrlAllow=!0),t.sendWikiCutObj())})),this.wikiContentWaitCut.sort((function(e,t){return e.order>t.order?1:-1})),this.splitCompleteWikiContents=X(this.wikiContentWaitCut),this.splitCompleteWikiContents=q(this.splitCompleteWikiContents,this.selectedMetaDataColumns,this.fileNameMeta,this.corpusNameMeta),this.isEditMetadata=!0,this.$nextTick((function(){this.$refs.hotTableComponent.hotInstance.loadData(this.splitCompleteWikiContents)})),this.colHeaders=["文件標題","文本內容","檔案名稱","文獻集名稱"],this.colHeaders=this.colHeaders.concat(this.selectedMetaDataColumns.map((function(e){return e.headerName}))),this.colHeaders=this.colHeaders.concat("文件次序編碼"),this.isEditMetaTable=!1,this.activeStep=3},reOrderFile:function(){this.splitCompleteWikiContents=this.splitCompleteWikiContents.sort((function(e,t){return e.fileOrder-t.fileOrder}))},checkForm:function(){return this.wikiUrls?1:(this.urlFieldHint="is-danger",this.isInputEmpty=!0,0)},confirmAdd:function(e){e&&(this.extendedLinks=this.extendedLinks.concat(this.selectRefLinks),this.activeStep=1),this.selectRefLinks=[],this.isAddExtendedLinks=!1},checkContentValue:function(e){e.isFixContent=!e.isFixContent,e.isContentOpen=!e.isContentOpen},deleteContentValue:function(e){this.wikiDocuments.splice(e,1)},download:function(){var e=document.createElement("a"),t=""==this.filename?"".concat(y.getFullYear(),"_").concat(y.getMonth(),"_").concat(y.getDate(),".xml"):this.filename;e.setAttribute("href","data:text/xml;charset=utf-8,"+encodeURIComponent(this.wikiContents)),e.setAttribute("download",t),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},copyTestingCode:function(){var e=k("#wikiContents").select((function(){try{alert("Testing code was copied ")}catch(e){alert("Oops, unable to copy")}}));e.setAttribute("type","hidden"),window.getSelection().removeAllRanges()},onCopy:function(){alert("Copying Success!!")},selectAllExtendLinks:function(){var e=this;this.extendedLinks.forEach((function(t){e.confirmLinks.push(t)}))},closeEventHandler:function(){this.$refs.multiselect.isOpen=!0},generateXml:function(){var e=Object(Je["a"])(this.splitCompleteWikiContents);e.forEach((function(e){delete e["fileOrder"]})),this.showXmlString=Oe(e,this.selectedMetaDataColumns,this.wikiTags,this.corpusNameMeta),this.activeStep=5},copyXML:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText(this.showXmlString);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),downloadXML:function(){var e=document.createElement("a");e.download="".concat(this.corpusNameMeta),e.style.display="none";var t=new Blob([this.showXmlString],{type:"text/xml"});e.href=URL.createObjectURL(t),document.body.appendChild(e),e.click(),document.body.removeChild(e)},openLoginModal:function(){this.isOpenUploadModal=!0},login:function(){var e=this;function t(){qe["a"].open("Login Failed...")}this.account&&this.password?this.widget.login(this.account,this.password,(function(){qe["a"].open("Login Success!"),e.isUploadable=!0}),(function(){t()})):t()},uploadXML:function(){if(!this.xml)return qe["a"].open("Require Content...");var e={dummy:{name:"dbTitleForImport",value:this.uploadFileName},file:{value:this.xml,filename:this.uploadFileName+".xml",name:"importedFiles[]"}};this.widget.uploadMultipart(e,(function(){qe["a"].open("Upload Success!")}),(function(){qe["a"].open("Upload Failed...")}))}}},He=$e,Ve=(n("a1ca"),n("b0a0"),Object(G["a"])(He,l,c,!1,null,"fd464dbc",null)),Ge=Ve.exports,Ye=(n("5abe"),n("a6f4"));o["default"].use(Ye["a"]),o["default"].use(r["a"]),o["default"].config.productionTip=!1,new o["default"]({render:function(e){return e(Ge)}}).$mount("#app")},"62b8":function(e,t,n){"use strict";n("479e")},a1ca:function(e,t,n){"use strict";n("b7bb")},a685:function(e,t,n){},b0a0:function(e,t,n){"use strict";n("452c")},b7bb:function(e,t,n){},be79:function(e,t,n){},e945:function(e,t,n){var i={"./af":"c00a","./af.js":"c00a","./ar":"c97e","./ar-dz":"0162","./ar-dz.js":"0162","./ar-kw":"fae4","./ar-kw.js":"fae4","./ar-ly":"aa71","./ar-ly.js":"aa71","./ar-ma":"5d88","./ar-ma.js":"5d88","./ar-sa":"a10a","./ar-sa.js":"a10a","./ar-tn":"152f","./ar-tn.js":"152f","./ar.js":"c97e","./az":"54cd","./az.js":"54cd","./be":"3dd4","./be.js":"3dd4","./bg":"a802","./bg.js":"a802","./bm":"7cd9","./bm.js":"7cd9","./bn":"7151","./bn.js":"7151","./bo":"323a","./bo.js":"323a","./br":"3138","./br.js":"3138","./bs":"acbc","./bs.js":"acbc","./ca":"0876","./ca.js":"0876","./cs":"0aef","./cs.js":"0aef","./cv":"8be7","./cv.js":"8be7","./cy":"6764","./cy.js":"6764","./da":"7612","./da.js":"7612","./de":"4da8","./de-at":"976e","./de-at.js":"976e","./de-ch":"686e","./de-ch.js":"686e","./de.js":"4da8","./dv":"39df","./dv.js":"39df","./el":"4c94","./el.js":"4c94","./en-SG":"f58c","./en-SG.js":"f58c","./en-au":"4415","./en-au.js":"4415","./en-ca":"499b","./en-ca.js":"499b","./en-gb":"4e86","./en-gb.js":"4e86","./en-ie":"7c7e","./en-ie.js":"7c7e","./en-il":"f923","./en-il.js":"f923","./en-nz":"f766","./en-nz.js":"f766","./eo":"8135","./eo.js":"8135","./es":"6ebc","./es-do":"e481","./es-do.js":"e481","./es-us":"d75c","./es-us.js":"d75c","./es.js":"6ebc","./et":"e662","./et.js":"e662","./eu":"65b7","./eu.js":"65b7","./fa":"0028","./fa.js":"0028","./fi":"5fd1","./fi.js":"5fd1","./fo":"72f4","./fo.js":"72f4","./fr":"6e81","./fr-ca":"c471","./fr-ca.js":"c471","./fr-ch":"f797","./fr-ch.js":"f797","./fr.js":"6e81","./fy":"d8b9","./fy.js":"d8b9","./ga":"064e","./ga.js":"064e","./gd":"94ef","./gd.js":"94ef","./gl":"c74b","./gl.js":"c74b","./gom-latn":"5601","./gom-latn.js":"5601","./gu":"2a3d","./gu.js":"2a3d","./he":"9669","./he.js":"9669","./hi":"e85f","./hi.js":"e85f","./hr":"bf5e","./hr.js":"bf5e","./hu":"9901","./hu.js":"9901","./hy-am":"012e","./hy-am.js":"012e","./id":"ba8c","./id.js":"ba8c","./is":"c6c1","./is.js":"c6c1","./it":"6101","./it-ch":"b2d4","./it-ch.js":"b2d4","./it.js":"6101","./ja":"f2b8","./ja.js":"f2b8","./jv":"d9e8","./jv.js":"d9e8","./ka":"4d4c","./ka.js":"4d4c","./kk":"b770","./kk.js":"b770","./km":"b388","./km.js":"b388","./kn":"a056","./kn.js":"a056","./ko":"44157","./ko.js":"44157","./ku":"27e5","./ku.js":"27e5","./ky":"d2f5","./ky.js":"d2f5","./lb":"01fe","./lb.js":"01fe","./lo":"d759","./lo.js":"d759","./lt":"d47b","./lt.js":"d47b","./lv":"3793","./lv.js":"3793","./me":"b26f","./me.js":"b26f","./mi":"d0b2","./mi.js":"d0b2","./mk":"8357","./mk.js":"8357","./ml":"b4f4","./ml.js":"b4f4","./mn":"c7bf","./mn.js":"c7bf","./mr":"96b4","./mr.js":"96b4","./ms":"9bf3","./ms-my":"64f3","./ms-my.js":"64f3","./ms.js":"9bf3","./mt":"44b6","./mt.js":"44b6","./my":"35e8","./my.js":"35e8","./nb":"cd6b","./nb.js":"cd6b","./ne":"ee29","./ne.js":"ee29","./nl":"fd25","./nl-be":"11d4","./nl-be.js":"11d4","./nl.js":"fd25","./nn":"a90d","./nn.js":"a90d","./pa-in":"048e","./pa-in.js":"048e","./pl":"b099","./pl.js":"b099","./pt":"8cc1","./pt-br":"cd1a","./pt-br.js":"cd1a","./pt.js":"8cc1","./ro":"4f7b","./ro.js":"4f7b","./ru":"4a7a","./ru.js":"4a7a","./sd":"441d","./sd.js":"441d","./se":"1e99","./se.js":"1e99","./si":"6c0c","./si.js":"6c0c","./sk":"5234","./sk.js":"5234","./sl":"f896","./sl.js":"f896","./sq":"34ed","./sq.js":"34ed","./sr":"849e","./sr-cyrl":"85d6","./sr-cyrl.js":"85d6","./sr.js":"849e","./ss":"4061","./ss.js":"4061","./sv":"d88f","./sv.js":"d88f","./sw":"e7a7","./sw.js":"e7a7","./ta":"d3b3","./ta.js":"d3b3","./te":"eed5","./te.js":"eed5","./tet":"b816","./tet.js":"b816","./tg":"8a7b","./tg.js":"8a7b","./th":"19cc","./th.js":"19cc","./tl-ph":"672a","./tl-ph.js":"672a","./tlh":"3f0d","./tlh.js":"3f0d","./tr":"b6ff","./tr.js":"b6ff","./tzl":"3455","./tzl.js":"3455","./tzm":"4707","./tzm-latn":"022c","./tzm-latn.js":"022c","./tzm.js":"4707","./ug-cn":"39ef","./ug-cn.js":"39ef","./uk":"6901","./uk.js":"6901","./ur":"bc69","./ur.js":"bc69","./uz":"1d5c","./uz-latn":"1f6a","./uz-latn.js":"1f6a","./uz.js":"1d5c","./vi":"9128","./vi.js":"9128","./x-pseudo":"a886","./x-pseudo.js":"a886","./yo":"1db8","./yo.js":"1db8","./zh-cn":"ed0f","./zh-cn.js":"ed0f","./zh-hk":"b487","./zh-hk.js":"b487","./zh-tw":"1940","./zh-tw.js":"1940"};function a(e){var t=s(e);return n(t)}function s(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=s,e.exports=a,a.id="e945"},ea11:function(e,t,n){"use strict";n("1afe")}});
//# sourceMappingURL=app.e55d1d72.js.map